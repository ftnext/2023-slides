
<!DOCTYPE html>

<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <title>å¥½ãã¨ã‹å«Œã„ã¨ã‹ã¯ã„ã„ã€ç·´ç¿’ã—ã¦ãƒ†ã‚¹ãƒˆã‚’æ›¸ã‘ã‚‹ã‚ˆã†ã«ãªã‚‹ã‚“ã </title>
    <link rel="stylesheet" type="text/css" href="../_static/revealjs4/dist/reveal.css" />
    <link rel="stylesheet" href="../_static/revealjs4/dist/theme/black.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/revealjs4/plugin/highlight/zenburn.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/common.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/translations.js"></script>
    <script src="../_static/design-tabs.js"></script>
    <link rel="index" title="ç´¢å¼•" href="../genindex.html" />
    <link rel="search" title="æ¤œç´¢" href="../search.html" />
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    


    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@ftnext">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://ftnext.github.io/2023-slides/pyconapac/practice-test-code.html">
    <meta property="og:title" content="å¥½ãã¨ã‹å«Œã„ã¨ã‹ã¯ã„ã„ã€ç·´ç¿’ã—ã¦ãƒ†ã‚¹ãƒˆã‚’æ›¸ã‘ã‚‹ã‚ˆã†ã«ãªã‚‹ã‚“ã ">
    <meta property="og:description" content="2023/10 PyCon APAC 2023">
    <meta property="og:image" content="https://ftnext.github.io/2023-slides/_static/ogps/pyconapac.png">

  </head><body>
    <div class="reveal">
        <div class="slides">
            <section >
<h1>å¥½ãã¨ã‹å«Œã„ã¨ã‹ã¯ã„ã„ã€ç·´ç¿’ã—ã¦ãƒ†ã‚¹ãƒˆã‚’æ›¸ã‘ã‚‹ã‚ˆã†ã«ãªã‚‹ã‚“ã </h1>
</section>
<section >
<h2>å¥½ãã¨ã‹å«Œã„ã¨ã‹ã¯ã„ã„ã€ <strong>ç·´ç¿’ã—ã¦ãƒ†ã‚¹ãƒˆã‚’æ›¸ã‘ã‚‹ã‚ˆ</strong> ã†ã«ãªã‚‹ã‚“ã </h2>
<p>æ—¥æœ¬èªè³‡æ–™ãƒ» <strong>English talk</strong> ã§ã™</p>
<dl class="field-list simple">
<dt class="field-odd">Event<span class="colon">:</span></dt>
<dd class="field-odd"><p>PyCon APAC 2023</p>
</dd>
<dt class="field-even">Presented<span class="colon">:</span></dt>
<dd class="field-even"><p>2023/10/27 nikkie</p>
</dd>
</dl>
<aside class="notes">
The title is &quot;Like It or Not, Practice Until You Can Write Tests&quot;.
Thank you for choosing this talk. Enjoy it!</aside>
<aside class="notes">
ã‚¢ãƒ‹ãƒ¡ã®ã‚¹ãƒ©ãƒ³ã‚°ã™ãã¦ã€è‹±èªã§ä¼ãˆã‚‹ã®ãŒé›£ã—ã„
15åˆ†è©±ã—ã¦ã„ãã¾ã™</aside>
</section>
<section>
<section >
<h2>ãŠå‰ã€èª°ã‚ˆ</h2>
<ul class="simple">
<li><p>nikkieï¼ˆã«ã£ããƒ¼ï¼‰ ï¼ <span class="fab fa-twitter"></span> <a class="reference external" href="https://twitter.com/ftnext">&#64;ftnext</a> ï¼ <span class="fab fa-github"></span> <a class="reference external" href="https://github.com/ftnext">&#64;ftnext</a></p></li>
<li><p>æ ªå¼ä¼šç¤¾ãƒ¦ãƒ¼ã‚¶ãƒ™ãƒ¼ã‚¹ã®ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚¨ãƒ³ãƒ†ã‚£ã‚¹ãƒˆï¼ˆ<a class="reference external" href="https://hrmos.co/pages/uzabase/jobs/1829077236709650481">We're hiring!</a>ï¼‰</p></li>
</ul>
<img alt="https://drive.google.com/uc?id=19PMMnkqDiFMCJBPwoA1B51ltQBG0y4kL" src="https://drive.google.com/uc?id=19PMMnkqDiFMCJBPwoA1B51ltQBG0y4kL" />
<aside class="notes">
Please call me nikkie.
I usually write Python as a data scientist at a company &quot;Uzabase&quot;.</aside>
<aside class="notes">
ã«ã£ããƒ¼ã¨ç”³ã—ã¾ã™ã€‚
ãµã ã‚“ã¯ãƒ¦ãƒ¼ã‚¶ãƒ™ãƒ¼ã‚¹ã¨ã„ã†ä¼šç¤¾ã§ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚¨ãƒ³ãƒ†ã‚£ã‚¹ãƒˆã¨ã—ã¦Pythonã‚’æ›¸ã„ã¦ã„ã¾ã™</aside>
</section>
<section >
<h3>ãŠå‰ã€èª°ã‚ˆ ç¶šï¼‰Pythonã¨ã‚¢ãƒ‹ãƒ¡ãŒå¥½ã</h3>
<blockquote>
<div><div class="line-block">
<div class="line">ã„ã¾ã¯ã¾ã ã§ããªãã¦ã‚‚å¤§ä¸ˆå¤«ã€‚</div>
<div class="line"><strong>ã“ã‚Œã‹ã‚‰ã§ãã‚‹ã‚ˆã†ã«ãªã‚Œã°ã„ã„</strong></div>
</div>
</div></blockquote>
<p>æœ€è¿‘ãƒãƒã£ã¦ã‚‹ #ãƒŸãƒªã‚¢ãƒ‹ãƒã‚¿ãƒãƒ¬æ„Ÿæƒ³</p>
<aside class="notes">
(Continuing with self-introduction,) I love Python and anime.
Here's a quote from a show I've recently become engrossed in:
&quot;It's okay if you can't do it now.
With practice, you'll be able to in the future&quot;
Now, let's dive into the main topic.</aside>
<aside class="notes">
è‡ªå·±ç´¹ä»‹ã®ç¶šãã§ã™ãŒã€Pythonã¨ã‚¢ãƒ‹ãƒ¡ãŒå¥½ãã§ã™ã€‚
æœ€è¿‘ãƒãƒã£ã¦ã„ã‚‹ä½œå“ã®ä¸€ç¯€ãªã®ã§ã™ãŒã€
ã„ã¾ã¯ã¾ã ã§ããªãã¦ã‚‚å¤§ä¸ˆå¤«ã€‚
ã“ã‚Œã‹ã‚‰ã§ãã‚‹ã‚ˆã†ã«ãªã‚Œã°ã„ã„ã€‚
æœ¬ç·¨ã«å…¥ã£ã¦ã„ãã¾ã—ã‚‡ã†</aside>
<aside class="notes">
https://twitter.com/ftnext/status/1715665132804841707</aside>
</section>
</section>
<section>
<section >
<h2>ç·´ç¿’ã—ã¦ãƒ†ã‚¹ãƒˆã‚’æ›¸ã‘ã‚‹ã‚ˆã†ã«ãªã‚‹ã‚“ã </h2>
<ul class="simple">
<li><p>å‰æï¼šPythonã® <strong>é–¢æ•°</strong> ãŒæ›¸ã‘ã‚‹</p></li>
<li><p>ã„ã¾ã¯ã¾ã ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ãŸã“ã¨ãŒãªãã¦å¤§ä¸ˆå¤«</p></li>
</ul>
<aside class="notes">
This talk is intended for those of you who can write Python functions.
Don't worry if you've never written test code before!
Let's practice and get to the point where we can write tests.</aside>
<aside class="notes">
ã“ã®ãƒˆãƒ¼ã‚¯ã¯Pythonã®é–¢æ•°ãŒæ›¸ã‘ã‚‹æ–¹ã«èã„ã¦ã„ãŸã ã‘ãŸã‚‰ã„ã„ãªã¨æ€ã£ã¦ã„ã¾ã™ã€‚
ã„ã¾ã¯ã¾ã ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ãŸã“ã¨ãŒãªãã¦å¤§ä¸ˆå¤«ã§ã™ï¼
ç·´ç¿’ã—ã¦ãƒ†ã‚¹ãƒˆã‚’æ›¸ã‘ã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ãã¾ã—ã‚‡ã†</aside>
</section>
<section >
<h3>ãŠå“æ›¸ãï¼ˆå…¼ æŒã¡å¸°ã‚Œã‚‹ã‚‚ã®ï¼‰</h3>
<ol class="arabic simple">
<li><p>ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ãŒæ›¸ã‘ã‚‹ãƒ¡ãƒªãƒƒãƒˆ</p></li>
<li><p>doctestã®ä½¿ã„æ–¹</p></li>
<li><p>pytestã®ä½¿ã„æ–¹</p></li>
</ol>
<aside class="notes">
I'm planning to cover three main points.
First, I'll discuss the benefits of writing test code.
After that, I'll show you two methods to write test codes.</aside>
<aside class="notes">
å¤§ãã3ã¤ã®ã“ã¨ã‚’è©±ãã†ã¨æ€ã£ã¦ã„ã¾ã™ã€‚
ã¾ãšãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ãŒæ›¸ã‘ã‚‹ã¨ã“ã‚“ãªã„ã„ã“ã¨ãŒã‚ã‚‹ã‚ˆã¨ã„ã†è©±ã‚’ã—ã¾ã™ã€‚
ãã®å¾Œãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã‚’ã©ã†æ›¸ãã®ã‹ã«å¯¾ã—ã¦ã€2ã¤ã®ã‚„ã‚Šæ–¹ã‚’ç¤ºã—ã¾ã™ã€‚</aside>
</section>
<section >
<h3>å‹•ä½œç’°å¢ƒ &amp; ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰</h3>
<ul class="simple">
<li><p>Python 3.12.0 (latestğŸ™Œ)</p></li>
<li><p><span class="fab fa-github"></span> <a class="reference external" href="https://github.com/ftnext/2023-slides/tree/main/samplecode/python-testing/doctest-example">doctest-example</a></p></li>
<li><p><span class="fab fa-github"></span> <a class="reference external" href="https://github.com/ftnext/2023-slides/tree/main/samplecode/python-testing/pytest-example">pytest-example</a></p></li>
</ul>
<aside class="notes">
Sample codes work at Python 3.12.0!</aside>
<aside class="notes">
ã‚³ãƒãƒ³ãƒ‰æ§ãˆ
python -m doctest fizzbuzz.py example_repr.py
pytest --doctest-modules -v
python -m doctest ../../../source/pyconapac/doctest.rst.txt ../../../source/pyconapac/pytest.rst.txt</aside>
</section>
</section>
<section >
<h2>ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ãŒæ›¸ã‘ã‚‹ãƒ¡ãƒªãƒƒãƒˆ</h2>
<aside class="notes">
First, let's talk about the benefits of being able to write test code.</aside>
<aside class="notes">
ã¾ãšã€ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ãŒæ›¸ã‘ã‚‹ã¨ã©ã‚“ãªã„ã„ã“ã¨ãŒã‚ã‚‹ã‹ã‚’è©±ã—ã¦ã„ãã¾ã™</aside>
</section>
<section>
<section >
<h2>ä¸€åº¦æ›¸ã„ãŸã‚³ãƒ¼ãƒ‰ã¯æ”¹å–„ï¼ˆå¤‰æ›´ï¼‰ã‚’å…ã‚Œãªã„</h2>
<ul class="simple">
<li><p>æŒã¦ã‚‹çŸ¥è­˜ã‚’å…¨ã¦å‹•å“¡ã—ã¦æ›¸ã„ãŸãŒã€ã‚ˆã‚Šé©åˆ‡ãªæ–‡æ³•ã‚’çŸ¥ã‚‰ãªã‹ã£ãŸ</p></li>
<li><p><strong>æ–°ã—ãçŸ¥ã£ãŸæ›¸ãæ–¹</strong> ã§æ›¸ãç›´ã—ãŸã„ â¡ï¸ å­¦ã³ã«ãªã‚Šã€Pythonã®åŠ›ãŒã¤ãğŸ’ª</p></li>
</ul>
<aside class="notes">
Personally, I don't think there's ever a time when you shouldn't improve the code you've written.
You might have written the code using all the knowledge you have, but you may not have known a more appropriate syntax.
I often find that rewriting code to be more efficient is a great learning experience, and it builds your proficiency in Python.</aside>
<aside class="notes">
ç§ã€æ€ã†ã‚“ã§ã™ã‘ã©ã€ä¸€åº¦æ›¸ã„ãŸã‚³ãƒ¼ãƒ‰ã‚’æ”¹å–„ã—ãªã„ã“ã¨ã£ã¦ãªã„ã‚“ã˜ã‚ƒãªã„ã‹ãªã¨ã€‚
æŒã¦ã‚‹çŸ¥è­˜ã‚’å…¨ã¦ä½¿ã£ã¦æ›¸ã„ãŸã‚³ãƒ¼ãƒ‰ã ãŒã€ã‚ˆã‚Šé©åˆ‡ãªæ–‡æ³•ã‚’çŸ¥ã‚‰ãªã‹ã£ãŸã€‚
ã‚ˆã‚Šã‚ˆã„ã‚„ã‚Šæ–¹ã§æ›¸ãç›´ã—ãŸã„ã¨æ€ã„ã¾ã™ã—ã€å®Ÿéš›æ›¸ãç›´ã™ã¨å­¦ã³ã«ãªã‚Šã€Pythonã®åŠ›ãŒã¤ãã¨çµŒé¨“ã—ã¦ãã¾ã—ãŸã€‚</aside>
<aside class="notes">
PythonãŒãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ—ã—ã¦æ–‡æ³•è‡ªä½“ãŒé€²åŒ–</aside>
</section>
<section >
<h3>ä¾‹ï¼šFizzBuzz</h3>
<pre data-id="fizzbuzz"><code data-trim data-noescape class="python">def fizzbuzz(number: int) -&gt; str:
    if number % 3 == 0 and number % 5 == 0:
        return &quot;FizzBuzz&quot;
    elif number % 3 == 0:
        return &quot;Fizz&quot;
    elif number % 5 == 0:
        return &quot;Buzz&quot;
    else:
        return str(number)</code></pre>
<p><a class="reference external" href="https://pycamp.pycon.jp/textbook/2_intro.html#fizzbuzz">https://pycamp.pycon.jp/textbook/2_intro.html#fizzbuzz</a> ãƒªã‚¹ãƒˆ2.14</p>
<aside class="notes">
Let's take the example of the FizzBuzz program.
It's a familiar programming task where you return &quot;Fizz&quot; for multiples of 3 and so on.</aside>
<aside class="notes">
ä¾‹ã¯FizzBuzzã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§ã™ã€‚
3ã®å€æ•°ã®ã¨ãã¯Fizzã€5ã®å€æ•°ã®ã¨ãã¯Buzzã¨è¿”ã™ã¨ã„ã†ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã§ã¯ãŠãªã˜ã¿ã®èª²é¡Œã§ã™ã­</aside>
</section>
<section >
<h3>Structural Pattern Matching (Python 3.10ã€œ)</h3>
<pre data-id="structural-pattern-matching-python-3-10"><code data-trim data-noescape class="python">def fizzbuzz(number: int) -&gt; str:
    match number % 3, number % 5:
        case 0, 0: return &quot;FizzBuzz&quot;
        case 0, _: return &quot;Fizz&quot;
        case _, 0: return &quot;Buzz&quot;
        case _, _: return str(number)</code></pre>
<p><a class="reference external" href="https://gihyo.jp/news/report/01/pyconjp2021/0002">https://gihyo.jp/news/report/01/pyconjp2021/0002</a></p>
<p>è£ã§ã€Œ<a class="reference external" href="https://2023-apac.pycon.jp/timetable?id=DXWXGJ">Introduction to Structural Pattern Matching</a>ã€</p>
<aside class="notes">
With Python 3.10's Structural Pattern Matching, you can write it like this! It's quite surprising.</aside>
<aside class="notes">
ã“ã®FizzBuzzã§ã™ãŒã€Python 3.10ã‹ã‚‰ä½¿ãˆã‚‹ã‚ˆã†ã«ãªã£ãŸStructural Pattern Matchingã‚’ä½¿ã†ã¨
ã“ã‚“ãªæ„Ÿã˜ã§ã‚¹ãƒƒã‚­ãƒªæ›¸ã‘ã¡ã‚ƒã†ï¼ ã³ã£ãã‚Šã§ã™ã‚ˆã­</aside>
</section>
</section>
<section>
<section >
<h2>æ›¸ãæ›ãˆã§æŒ¯ã‚‹èˆã„ã‚’å¤‰ãˆã¦ã„ãªã„ã ã‚ã†ã‹ï¼Ÿ</h2>
<p><strong>ä¸å®‰</strong> ã«å¯¾å‡¦ã™ã‚‹ã„ãã¤ã‹ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ</p>
<aside class="notes">
However, there's a fear that you might change the behavior unintentionally with the rewrite.
There are various approaches to address this fear.</aside>
<aside class="notes">
ã§ã™ãŒã€æ›¸ãæ›ãˆã§æŒ¯ã‚‹èˆã„ã‚’å¤‰ãˆã¡ã‚ƒã£ã¦ã„ã‚‹ã‹ã‚‚ã¨ã„ã†ä¸å®‰ã‚’æ„Ÿã˜ã¾ã™ã€‚
ã“ã®ä¸å®‰ã«ã¯ã„ã‚ã‚“ãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒãŒã‚ã‚‹ã¨æ€ã„ã¾ã™ã€‚</aside>
<aside class="notes">
fearï¼ˆä¸å®‰ï¼‰</aside>
</section>
<section >
<h3>(A) ç¥ˆã‚‹ ğŸ™</h3>
<ul class="simple">
<li><p>ğŸ™ğŸ™ã€Œã©ã†ã‹å¤‰ã‚ã£ã¦ã„ã¾ã›ã‚“ã‚ˆã†ã«ã€ğŸ™ğŸ™</p></li>
<li><p>æŒ¯ã‚‹èˆã„ã‚’å¤‰ãˆã¦ã„ãªã„ã‹ä¸å®‰ã ãŒã€ <em>ä½•ã‚‚ç¢ºèªã¯ã—ãªã„</em></p></li>
</ul>
<aside class="notes">
One approach is to pray for the fear.
&quot;I'm rewriting it, but please don't change anything!&quot;
(While the fear might diminish,) IN fact you're not really confirming anything.</aside>
<aside class="notes">
ä¾‹ãˆã°ç¥ˆã‚Šã§ä¸å®‰ã«ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã€‚
æ›¸ãæ›ãˆã‚‹ã‚“ã ã‘ã©å¤‰ã‚ã£ã¦ã„ãªã„ã§ãã‚Œï¼ã¨ã„ã†ç¥ˆã‚Šã§ã™ã€‚
ä¸å®‰ã¯è–„ã¾ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€ä½•ã‚‚ç¢ºèªã—ã¦ã„ã¾ã›ã‚“ã­</aside>
</section>
<section >
<h3>(B) æ‰‹ã§å‹•ä½œç¢ºèª âœ‹</h3>
<ul class="simple">
<li><p>ä¾‹ãˆã°å¯¾è©±çš„ã« <code class="docutils literal notranslate"><span class="pre">fizzbuzz</span></code> é–¢æ•°ã‚’å®Ÿè¡Œ</p></li>
</ul>
<pre data-id="b"><code data-trim data-noescape class="pycon">&gt;&gt;&gt; from fizzbuzz import fizzbuzz  
&gt;&gt;&gt; fizzbuzz(15)  
'FizzBuzz'</code></pre>
<ul class="simple">
<li><p>å®‰å¿ƒã§ãã‚‹ãŒã€ <em>é–¢æ•°ã®æ•°ãŒå¢—ãˆã¦</em> ã„ãã¨ç¾å®Ÿçš„ã§ã¯ãªã•ãã†</p></li>
</ul>
<aside class="notes">
Another approach is to manually check.
Start the interpreter, import fizzbuzz, pass 15(fifteen), and see if it returns &quot;FizzBuzz&quot;.
(If it behaves as expected, you can feel at ease.
However,) as the number of functions you want to check increases, it might become challenging.</aside>
<aside class="notes">
åˆ¥ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã¨ã—ã¦ã€æ‰‹ã§å‹•ä½œç¢ºèªã§ã™ã€‚
ã‚¤ãƒ³ã‚¿ãƒ—ãƒªã‚¿ã‚’ç«‹ã¡ä¸Šã’ã¦ã€fizzbuzzã‚’importã—ã¦15ã‚’æ¸¡ã—ã¦FizzBuzzã¨è¿”ã‚‹ã€‚
ã“ã‚Œã¯æœŸå¾…é€šã‚Šã®å‹•ãã ï¼ã¨å®‰å¿ƒã§ãã‚‹ã¨æ€ã„ã¾ã™ã€‚
ã§ã™ãŒã€ç¢ºèªã—ãŸã„é–¢æ•°ã®æ•°ãŒå¢—ãˆã¦ã„ãã¨å¤§å¤‰ãã†ã§ã™ã­</aside>
</section>
<section >
<h3>(C) ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦å‹•ä½œç¢ºèª ğŸ¤–</h3>
<ul class="simple">
<li><p>ã“ã®ç™ºè¡¨ã®æœ¬é¡Œ</p></li>
<li><p>ã€Œæ‰‹ã§å‹•ä½œç¢ºèªã€ã® <strong>è‡ªå‹•åŒ–</strong> ï¼ˆãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãï¼‰</p></li>
<li><p>ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§ä½¿ã†éƒ¨å“ã®ã‚³ãƒ¼ãƒ‰ã¯ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’æ›¸ã„ã¦å‹•ä½œç¢ºèªã™ã‚‹ã¨ã„ã†è€ƒãˆæ–¹</p></li>
</ul>
<aside class="notes">
Third approach is to write code to automate the manual check.
This is the main topic of this presentation.
We'll write what's called test code.
(Considering it as a component that the program uses, we'll use the program to confirm its behavior.)</aside>
<aside class="notes">
3ã¤ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã€ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦å‹•ä½œç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚
ã“ã‚ŒãŒã“ã®ç™ºè¡¨ã®æœ¬é¡Œã§ã™ã€‚
æ‰‹ã§ã®ç¢ºèªã‚’è‡ªå‹•åŒ–ã—ã¦ã„ãã€‚ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã¨å‘¼ã°ã‚Œã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ã„ãã¾ã™ã€‚
ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒä½¿ã†éƒ¨å“ãªã®ã§ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§ä½¿ã£ã¦å‹•ä½œç¢ºèªã™ã‚‹ã¨è€ƒãˆã¦ã„ã¾ã™</aside>
<aside class="notes">
ã€Œå˜ä½“ãƒ†ã‚¹ãƒˆã€ã¯Appendixï¼Ÿ</aside>
</section>
<section >
<h3>ç”¨èªç´¹ä»‹(1/2) å®Ÿè¡Œçµæœ</h3>
<p>ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€ã„ãšã‚Œã‹</p>
<ul class="simple">
<li><p><strong>pass</strong> ï¼ˆå…¨ã¦é€šã‚‹ãƒ»æˆåŠŸï¼‰</p></li>
<li><p>fail ï¼ˆ1ã¤ã§ã‚‚å¤±æ•—ãƒ»è½ã¡ã‚‹ï¼‰</p></li>
</ul>
<aside class="notes">
Let's introduce some terminology here.
When you execute a set of test codes, there are only two outcomes: pass or fail.
&quot;Pass&quot; means all tests have succeeded.
If even one test fails, the entire set is marked as &quot;fail&quot;.</aside>
<aside class="notes">
ã“ã“ã§ç”¨èªã‚’ç´¹ä»‹ã—ã¾ã—ã‚‡ã†ã€‚
ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã®é›†åˆã‚’å…¨éƒ¨å®Ÿè¡Œã—ãŸã‚‰passã‹failã—ã‹ã‚ã‚Šã¾ã›ã‚“ã€‚
passã¯ãƒ†ã‚¹ãƒˆãŒå…¨ã¦æˆåŠŸã—ãŸã¨ã„ã†ã“ã¨ã§ã™ã€‚
ãƒ†ã‚¹ãƒˆãŒ1ã¤ã§ã‚‚å¤±æ•—ã™ã‚‹ã¨ãƒ†ã‚¹ãƒˆã‚‚failã¨ãªã‚Šã¾ã™ã€‚</aside>
</section>
<section >
<h3>ç”¨èªç´¹ä»‹(2/2) å€¤</h3>
<div class="literal-block-wrapper docutils container" id="id45">
<div class="code-block-caption"><span class="caption-text">ã‹ã—ã“ã¾ã£ãŸæ›¸ãæ–¹</span></div>
<pre><code data-trim data-noescape class="pycon">&gt;&gt;&gt; actual = fizzbuzz(15)  # ãƒ†ã‚¹ãƒˆå¯¾è±¡ã‚’å®Ÿè¡Œã—ãŸå€¤ 
&gt;&gt;&gt; expected = &quot;FizzBuzz&quot;  # æœŸå¾…çµæœ
&gt;&gt;&gt; actual == expected
True</code></pre>
</div>
<aside class="notes">
In formal way, The value returned by the subject you want to test is called &quot;actual&quot;,
and the result you expect is called &quot;expected&quot;.
You verify that actual and expected are equal.</aside>
<aside class="notes">
ã‚‚ã†1ã¤ã€ã‹ã—ã“ã¾ã£ãŸæ›¸ãæ–¹ã§ã™ãŒï¼ˆformal wayï¼‰ã€
ãƒ†ã‚¹ãƒˆã—ãŸã„å¯¾è±¡ã‚’å®Ÿè¡Œã—ãŸå€¤ã¯actualã€
æœŸå¾…ã™ã‚‹çµæœã‚’expectedã¨å‘¼ã‚“ã§ã€
actualã¨expectedãŒç­‰ã—ã„ã“ã¨ã‚’æ¤œè¨¼ã—ã¦ã„ã¾ã™</aside>
</section>
</section>
<section>
<section >
<h2>ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ãŒã‚ã‚‹ã¨</h2>
<table class="docutils align-default" id="id46">
<caption><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">actual</span> <span class="pre">==</span> <span class="pre">expected</span></code> ã‚’ <strong>ç°¡å˜ã«ç¢ºèª</strong> ã§ãã‚‹</span></caption>
<tbody>
<tr class="row-odd"><td><p>actual</p></td>
<td><p>expected</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">fizzbuzz(3)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;Fizz&quot;</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">fizzbuzz(5)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;Buzz&quot;</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">fizzbuzz(15)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;FizzBuzz&quot;</span></code></p></td>
</tr>
</tbody>
</table>
<aside class="notes">
I'll tell you a bit later how to write test code,
but even if you imagine having test code, it brings so many benefits.
For example, there's a test that checks if passing 3 to fizzbuzz returns the string &quot;Fizz&quot;.</aside>
<aside class="notes">
ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã‚’ã©ã†æ›¸ãã‹ã¯ã‚‚ã†å°‘ã—å…ˆã§ãŠä¼ãˆã—ã¾ã™ãŒã€
ä»®ã«ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ãŒã‚ã‚‹ã¨ã“ã‚“ãªã«ã„ã„ã“ã¨ãŒã‚ã‚Šã¾ã™ã‚ˆã€‚
ä¾‹ãˆã°ã€fizzbuzzã«3ã‚’æ¸¡ã™ã¨æ–‡å­—åˆ—ã®Fizz</aside>
</section>
<section >
<h3>ä¸å®‰ã¯é€€å±ˆã«å¤‰ã‚ã‚‹</h3>
<ul class="simple">
<li><p>å®Ÿè£…ä¸­ã€ä»•æ§˜ã‚’æº€ãŸã™ <strong>å‹•ä½œã™ã‚‹ã‚³ãƒ¼ãƒ‰</strong> ã§ã‚ã‚‹ã¨ç¢ºèªã§ãã‚‹ğŸ™Œ</p></li>
<li><p>æ›¸ãæ›ãˆã‚‹éš›ã‚‚ã€ãŠã‹ã—ãã—ã¦ã„ãŸã‚‰æ°—ä»˜ã‘ã‚‹ ğŸ™Œï¼ˆ<em>å›å¸°ãƒ†ã‚¹ãƒˆ</em>ï¼‰</p></li>
</ul>
<aside class="notes">
When the test passes, it means you have code that works as specified.
If you accidentally mess something up, the test will fail, and you'll notice.</aside>
<aside class="notes">
ãƒ†ã‚¹ãƒˆãŒpassã¨ã„ã†ã“ã¨ã¯ã€ä»•æ§˜ã‚’æº€ãŸã™å‹•ä½œã™ã‚‹ã‚³ãƒ¼ãƒ‰ã¨ã„ã†ã“ã¨ã§ã™ã€‚
ãŠã‹ã—ãã—ã¦ã—ã¾ã£ãŸã‚‰ãƒ†ã‚¹ãƒˆãŒfailã—ã¦æ°—ã¥ã‘ã¾ã™ã€‚
ã€Œä¸å®‰ã¯é€€å±ˆã«å¤‰ã‚ã‚‹ã€ã¨ã¯ã‚ˆãè¨€ã£ãŸã‚‚ã®ã ã¨æ€ã„ã¾ã™</aside>
<aside class="notes">
ãƒ†ã‚¹ãƒˆãŒå…¨ã¦passã™ã‚Œã°ã€æ›¸ãæ›ãˆã§å¤‰æ›´ã—ã¦ã„ãªã„</aside>
<aside class="notes">
ãƒ†ã‚¹ãƒˆãŒ1ã¤ã§ã‚‚failã—ãŸã‚‰ã€æ›¸ãæ›ãˆã§ä½•ã‹ãŠã‹ã—ãã—ã¦ã—ã¾ã£ãŸï¼ˆæ°—ã¥ã‘ã‚‹ï¼‰</aside>
</section>
<section >
<h3>æ›¸ãã‚³ãƒ¼ãƒ‰ã¯å¢—ãˆã¦ã„ã‚‹ã€ã‘ã‚Œã©</h3>
<ul class="simple">
<li><p>å®Ÿè£…ã«åŠ ãˆã¦ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã‚‚æ›¸ã</p></li>
<li><p>ã§ã‚‚ã€ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ <strong>&lt;&lt; ãƒ¡ãƒªãƒƒãƒˆ</strong> ã ã¨æ€ã†ã‹ã‚‰ã€ğŸ“£ç·´ç¿’ã—ã¦æ›¸ã‘ã‚‹ã‚ˆã†ã«ãªã‚‹ã‚“ã ï¼</p></li>
</ul>
<aside class="notes">
However, you have to write both the test code and the implementation. (It's a bit tough.)
Everything has its pros and cons, and I believe the benefits far outweigh the drawbacks from my experience.
So, in this talk, I'm encouraging you to give writing test code a try.</aside>
<aside class="notes">
ãŸã ã€ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã¨å®Ÿè£…ã¨ã€ä¸¡æ–¹æ›¸ã‹ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚ï¼ˆã¤ã‚‰ã„ã¨ã“ã‚ã ãªï¼‰
ã©ã‚“ãªã‚‚ã®ã«ãƒ¡ãƒªãƒƒãƒˆã¨ãƒ‡ãƒ¡ãƒªãƒƒãƒˆã‚‚ã‚ã‚‹ã¨æ€ã„ã¾ã™ã€‚
ç§ã¯çµŒé¨“ã‹ã‚‰ãƒ¡ãƒªãƒƒãƒˆãŒãƒ‡ãƒ¡ãƒªãƒƒãƒˆã‚’å¤§ããä¸Šå›ã‚‹ã¨æ€ã£ã¦ã„ã‚‹ã®ã§ã€ã“ã®ãƒˆãƒ¼ã‚¯ã§ã¯ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ã¿ã¾ã—ã‚‡ã†ã¨ä¼ãˆã¦ã„ã¾ã™</aside>
</section>
</section>
<section>
<section >
<h2>ğŸ¥Ÿãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã¯Pythonã®åŠ›ã‚’ã¤ã‘ã‚‹ä¸‹åœ°ï¼ˆN=1ï¼‰</h2>
<ul class="simple">
<li><p>ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã«ã‚ˆã‚Šã€ã€Œã“ã®å®Ÿè£…ã¯ä»•æ§˜ã‚’æº€ãŸã™ <strong>å‹•ä½œ</strong> ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã€ã¨ <strong>ç¢ºèª</strong> ã§ãã‚‹</p></li>
<li><p>æ–°ã—ãçŸ¥ã£ãŸæ–‡æ³•ã‚’è©¦ã—ã¦æ›¸ãæ›ãˆã‚‹ã¨ãã€ <strong>èª¤</strong> ã£ã¦æŒ¯ã‚‹èˆã„ã‚’å¤‰ãˆã¦ã—ã¾ã£ã¦ã‚‚ <strong>æ°—ã¥ã‘ã‚‹</strong></p></li>
</ul>
<aside class="notes">
To summarize what we've covered so far,
With test code, you can confirm that the implementation works as specified.
(Even when trying out new syntax you've learned and rewriting,)
you can catch if you unintentionally change the behavior.</aside>
<aside class="notes">
ã“ã“ã¾ã§ã‚’ã¾ã¨ã‚ã¾ã™ã¨ã€
ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ãŒã‚ã‚‹ã¨ã€å®Ÿè£…ã¯ä»•æ§˜ã‚’æº€ãŸã™å‹•ä½œã™ã‚‹ã‚³ãƒ¼ãƒ‰ã¨ç¢ºèªã§ãã¾ã™ã€‚
æ–°ã—ãçŸ¥ã£ãŸæ–‡æ³•ã‚’è©¦ã—ã¦æ›¸ãæ›ãˆã‚‹ã¨ãã€èª¤ã£ã¦æŒ¯ã‚‹èˆã„ã‚’å¤‰ãˆã¦ã—ã¾ã£ãŸã¨ãã‚‚æ°—ã¥ã‘ã¾ã™ã€‚</aside>
</section>
<section >
<h3>ãŠå“æ›¸ã</h3>
<ol class="arabic simple">
<li><p>ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ãŒæ›¸ã‘ã‚‹ãƒ¡ãƒªãƒƒãƒˆ</p></li>
<li><p><strong>doctestã®ä½¿ã„æ–¹</strong></p></li>
<li><p>pytestã®ä½¿ã„æ–¹</p></li>
</ol>
<p>ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã‚’ã©ã†æ›¸ãã‹ Part 1/2</p>
<aside class="notes">
I'll introduce two methods to write tests.
This is the first part of our discussion on how to write test code.
ğŸ™‹â€â™‚ï¸ Has anyone here heard of the term &quot;doctest&quot;?</aside>
<aside class="notes">
ã“ã“ã¾ã§ã‚’ã‚‚ã¨ã«ãƒ†ã‚¹ãƒˆã‚’æ›¸ã„ã¦ã¿ãŸã„æ–¹ã«ã€ãƒ†ã‚¹ãƒˆã®æ›¸ãæ–¹ã‚’2ã¤ç´¹ä»‹ã—ã¾ã™ã€‚
ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã‚’ã©ã†æ›¸ãã‹ã¨ã„ã†è©±ã®å‰åŠã§ã™ã€‚
ğŸ™‹â€â™‚ï¸doctestã¨ã„ã†åç§°ã‚’èã„ãŸã“ã¨ãŒã‚ã‚‹æ–¹ï¼Ÿ</aside>
</section>
</section>
<section >
<h2>doctest</h2>
<ul>
<li><p>æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒª</p></li>
<li><p><a class="reference external" href="https://docs.python.org/ja/3/library/doctest.html">https://docs.python.org/ja/3/library/doctest.html</a></p>
<blockquote>
<div><p>å¯¾è©±çš„ãªå®Ÿè¡Œä¾‹ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹</p>
</div></blockquote>
</li>
</ul>
<aside class="notes">
doctest is part of the standard library.
It's one of my favorite libraries.
What kind of library is it? It's for &quot;Testing interactive Python examples.&quot;</aside>
<aside class="notes">
doctestã¯æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ã‚ã‚Šã¾ã™ã€‚
ç§ã¯å¥½ããªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚
ã©ã‚“ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‹ã¨ã„ã†ã¨ã€ŒTest interactive Python examplesã€</aside>
</section>
<section>
<section >
<h2>é–¢æ•°ã®docstring</h2>
<blockquote>
<div><p>ã‚¯ãƒ©ã‚¹ã€é–¢æ•°ã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®æœ€åˆã®å¼ã§ã‚ã‚‹æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«</p>
<p>ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’æ›¸ãæ¨™æº–çš„ãªå ´æ‰€</p>
</div></blockquote>
<p><a class="reference external" href="https://docs.python.org/ja/3/glossary.html#term-docstring">https://docs.python.org/ja/3/glossary.html#term-docstring</a></p>
<aside class="notes">
We can write something called a docstring in functions, right?
If we look it up in the glossary,
it's described as &quot;A string literal which appears as the first expression in a function.
it(docstring) is the canonical place for documentation of the object.&quot;</aside>
<aside class="notes">
é–¢æ•°ã«ã¯docstringã¨ã„ã†ã‚‚ã®ãŒã‚ã‚Šã¾ã™ã‚ˆã­ã€‚
ç”¨èªé›†ã‚’å¼•ãã¨ã€
A string literal which appears as the first expression in a function.
it(docstring) is the canonical place for documentation of the object.</aside>
</section>
<section >
<h3>ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³æ–‡å­—åˆ— ã¨ã‚‚</h3>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/ja/3/tutorial/controlflow.html#tut-docstrings">https://docs.python.org/ja/3/tutorial/controlflow.html#tut-docstrings</a></p></li>
<li><p><strong>ä¸‰é€£å¼•ç”¨ç¬¦</strong> ã‚’ç”¨ã„ã€è¤‡æ•°è¡Œã«ã¾ãŸãŒã£ãŸæ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«ã¨ã™ã‚‹ã“ã¨ãŒã»ã¨ã‚“ã©</p></li>
</ul>
<aside class="notes">
docstring is also referred to as Documentation Strings.
It's written using three consecutive quotes.
Most of the time, it spans multiple lines since it can include line breaks.
Let's look an example. Seeing is believing.</aside>
<aside class="notes">
docstringã¯ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³æ–‡å­—åˆ—(Documentation Strings)ã¨ã‚‚å‘¼ã°ã‚Œã¾ã™ã€‚
ã‚¯ã‚©ãƒ¼ãƒˆã‚’3ã¤é€£ç¶šã•ã›ãŸæ–‡å­—åˆ—ã«ã—ã¾ã™ã€‚
æ”¹è¡Œã‚’å«ã‚ã‚‰ã‚Œã‚‹ã®ã§ã€è¤‡æ•°è¡Œã«ã¾ãŸãŒã£ãŸæ–‡å­—åˆ—ãŒã»ã¨ã‚“ã©ã§ã™ï¼ˆTODO ã‚¹ãƒ©ã‚¤ãƒ‰çµ„ã¿æ›ãˆï¼Ÿï¼‰
ç™¾èã¯ä¸€è¦‹ã«ã—ã‹ãšã§ã™ã€‚</aside>
<aside class="notes">
https://docs.python.org/ja/3/tutorial/introduction.html#text</aside>
</section>
<section >
<h3>docstringã®ä¾‹</h3>
<pre data-id="id17"><code data-trim data-noescape class="python">def fizzbuzz(number: int) -&gt; str:
    &quot;&quot;&quot;FizzBuzzã‚²ãƒ¼ãƒ ã‚’è§£ãé–¢æ•°ï¼ˆï¼š1è¡Œè¦ç´„ï¼‰

    ...ï¼ˆå¾Œè¿°ï¼‰...
    &quot;&quot;&quot;</code></pre>
<aside class="notes">
I've written a docstring for the fizzbuzz function.
After the function definition (def keyword), I've written a string using three consecutive quotes.</aside>
<aside class="notes">
fizzbuzzé–¢æ•°ã«docstringã‚’æ›¸ãã¾ã—ãŸã€‚
é–¢æ•°å®šç¾©ï¼ˆdefï¼‰ã®ç›´å¾Œã«ä¸‰é€£å¼•ç”¨ç¬¦ã‚’ä½¿ã£ãŸæ–‡å­—åˆ—ã‚’æ›¸ã„ã¦ã„ã¾ã™</aside>
<aside class="notes">
ãƒ†ã‚¹ãƒˆã‚’é€šã™ãŸã‚ã®å®šç¾©
&gt;&gt;&gt; def fizzbuzz(number: int) -&gt; str:
...     if number % 3 == 0 and number % 5 == 0:
...         return &quot;FizzBuzz&quot;
...     elif number % 3 == 0:
...         return &quot;Fizz&quot;
...     elif number % 5 == 0:
...         return &quot;Buzz&quot;
...     else:
...         return str(number)</aside>
</section>
<section >
<h3>Pythonå¯¾è©±ãƒ¢ãƒ¼ãƒ‰ã® <strong>å®Ÿè¡Œä¾‹ã‚’docstringã«æ›¸ã</strong></h3>
<pre data-id="python-docstring"><code data-trim data-noescape class="python">def fizzbuzz(number: int) -&gt; str:
    &quot;&quot;&quot;FizzBuzzã‚²ãƒ¼ãƒ ã‚’è§£ãé–¢æ•°

    &gt;&gt;&gt; fizzbuzz(1)
    '1'
    &gt;&gt;&gt; fizzbuzz(3)
    'Fizz'
    &quot;&quot;&quot;
</code></pre>
<aside class="notes">
In the docstring, I've written examples of what it would look like when you run the fizzbuzz function in Python's interactive mode.
Given 1, it returns the string &quot;1&quot;, and Given 3, it returns &quot;Fizz.&quot;</aside>
<aside class="notes">
docstringã®ç¶šãã«ã¯ã€Pythonã®å¯¾è©±ãƒ¢ãƒ¼ãƒ‰ã§fizzbuzzé–¢æ•°ã‚’å®Ÿè¡Œã—ãŸã¨ãã®å®Ÿè¡Œä¾‹ã‚’æ›¸ãã¾ã™ã€‚
1ã®ã¨ãã¯æ–‡å­—åˆ—1ã€3ã®ã¨ãã¯Fizz</aside>
</section>
</section>
<section>
<section >
<h2>å¯¾è©±ãƒ¢ãƒ¼ãƒ‰ã®å®Ÿè¡Œä¾‹ã‚’ <strong>ãƒ†ã‚¹ãƒˆã¨ã—ã¦å®Ÿè¡Œ</strong></h2>
<pre data-id="id18"><code data-trim data-noescape class="txt">.
â””â”€â”€ fizzbuzz.py</code></pre>
<ul class="simple">
<li><p><strong class="command">python -m doctest fizzbuzz.py</strong></p></li>
</ul>
<aside class="notes">
You have a file with tests written in the docstring,
then run it using command python -m doctest followed by the relative path to the file.
If the tests pass, there's no output.</aside>
<aside class="notes">
docstringã«å®Ÿè¡Œä¾‹ã‚’æ›¸ã„ãŸãƒ•ã‚¡ã‚¤ãƒ«ã ã‘ã‚’ä½œã‚Šã€python -m doctestã«ç›¸å¯¾ãƒ‘ã‚¹ã‚’æ¸¡ã—ã¦ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
passã™ã‚‹ã¨ãã¯ä½•ã‚‚å‡ºåŠ›ã—ã¾ã›ã‚“</aside>
</section>
<section >
<h3>å®Ÿè¡Œçµæœã®ç¢ºèªï¼ˆ<strong class="command">-v</strong> ã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰</h3>
<pre data-id="v"><code data-trim data-noescape class="shell">$ python -m doctest fizzbuzz.py -v
Trying:
    fizzbuzz(1)
Expecting:
    '1'
ok

4 passed and 0 failed.
Test passed.</code></pre>
<aside class="notes">
When you run doctest with the -v option, detailed test results are displayed.
Four tests passed, no failures. All tests have passed!</aside>
<aside class="notes">
-vã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä»˜ã‘ã¦doctestã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€å®Ÿè¡ŒçµæœãŒè©³ç´°ã«å‡ºåŠ›ã•ã‚Œã¾ã™ã€‚
ãƒ†ã‚¹ãƒˆ4ã¤ãŒé€šã‚Šã€å¤±æ•—ã¯ãªã—ã€‚ãƒ†ã‚¹ãƒˆå…¨ä½“ã¯passã—ã¾ã—ãŸ</aside>
</section>
<section >
<h3>é–¢æ•°ã®docstringã«é™ã‚‰ãšä½¿ãˆã¾ã™</h3>
<p>nikkieã¯ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆç‰¹ã«reStructuredTextï¼‰ã§é »ç¹ã«ä½¿ç”¨</p>
<ul class="simple">
<li><p>æ›¸ç±åŸ·ç­†</p></li>
<li><p><strong>ç™ºè¡¨è³‡æ–™</strong> ä½œæˆï¼ˆæœ¬è³‡æ–™å«ã‚€ï¼‰</p></li>
</ul>
<aside class="notes">
I use doctest not just in Python files.
The interactive Python examples in this slide have passed doctest, so I can present without any worries.</aside>
<aside class="notes">
ç§ã¯Pythonãƒ•ã‚¡ã‚¤ãƒ«ã«é™ã‚‰ãšdoctestã‚’ä½¿ã„ã¾ã™ã€‚
ã“ã®ã‚¹ãƒ©ã‚¤ãƒ‰ã®Pythonã®å¯¾è©±ä¾‹ã¯doctestãŒé€šã£ã¦ã„ã‚‹ã®ã§ã€ä¸å®‰ã‚’æ„Ÿã˜ãšã«ç™»å£‡ã§ãã¦ã„ã¾ã™</aside>
</section>
<section >
<h3>åˆ©ç”¨ã‚·ãƒ¼ãƒ³ï¼šãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«ã‚‚</h3>
<ul class="simple">
<li><p>ä¾‹ï¼šscikit-learn</p></li>
</ul>
<pre data-id="id20"><code data-trim data-noescape class="pycon">&gt;&gt;&gt; from sklearn.metrics import f1_score  
&gt;&gt;&gt; f1_score(y_true, y_pred, average='macro')  
0.26...</code></pre>
<p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.f1_score.html">https://scikit-learn.org/stable/modules/generated/sklearn.metrics.f1_score.html</a></p>
<aside class="notes">
doctest is also used in the documentation of popular libraries.
Here's an example from scikit-learn.</aside>
<aside class="notes">
doctestã¯æœ‰åãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã‚‚ä½¿ã‚ã‚Œã¦ã„ã¾ã™ã€‚
ã“ã‚Œã¯scikit-learnã®ä¾‹ã§ã™ï¼ˆTODO ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ï¼Ÿï¼‰
ï¼ŸPyTorch</aside>
</section>
</section>
<section>
<section >
<h2>doctestã®æ³¨æ„ç‚¹</h2>
<aside class="notes">
There are some nuances you should be aware of when using doctest.
The only difference between the code we looked at earlier and this one is that the string is enclosed with double quotes.</aside>
<aside class="notes">
doctestã«ã¯æ°—ã‚’ã¤ã‘ãªã‘ã‚Œã°ãªã‚‰ãªã„ç‚¹ãŒã‚ã‚Šã¾ã™ã€‚
å…ˆã»ã©ã®ã‚³ãƒ¼ãƒ‰ã¨ã®é•ã„ã¯æ–‡å­—åˆ—ãŒãƒ€ãƒ–ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆã¨ã„ã†ç‚¹ã ã‘ã§ã™</aside>
<aside class="notes">
ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã®doctestã‚’é€šã™ã ã‘ã®ã‚³ãƒ¼ãƒ‰ï¼ˆdoctest: +SKIPãŒtrimã•ã‚Œãªã„ãŸã‚ï¼‰
&gt;&gt;&gt; def fizzbuzz(number):
...     print('&quot;Fizz&quot;')</aside>
<pre data-id="id21"><code data-trim data-noescape class="python">def fizzbuzz(number: int) -&gt; str:
    &quot;&quot;&quot;FizzBuzzã‚²ãƒ¼ãƒ ã‚’è§£ãé–¢æ•°

    &gt;&gt;&gt; fizzbuzz(3)
    &quot;Fizz&quot;

    &quot;&quot;&quot;</code></pre>
<aside class="notes">
æ®‹ã‚Šã®ãƒ†ã‚¹ãƒˆã‚’é€šã™ãŸã‚ã®å®šç¾©
&gt;&gt;&gt; def fizzbuzz(number: int) -&gt; str:
...     if number % 3 == 0 and number % 5 == 0:
...         return &quot;FizzBuzz&quot;
...     elif number % 3 == 0:
...         return &quot;Fizz&quot;
...     elif number % 5 == 0:
...         return &quot;Buzz&quot;
...     else:
...         return str(number)</aside>
</section>
<section >
<h3>æ–‡å­—åˆ—ã« <strong>ãƒ€ãƒ–ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆ</strong> ã‚’ä½¿ã£ãŸã‚‰ãƒ†ã‚¹ãƒˆãŒfailğŸ˜±</h3>
<pre data-id="fail"><code data-trim data-noescape class="shell">$ python -m doctest fizzbuzz.py
Failed example:
    fizzbuzz(3)
Expected:
    &quot;Fizz&quot;
Got:
    'Fizz'

***Test Failed*** 1 failures.</code></pre>
<aside class="notes">
This test will fail.
The expected value is &quot;Fizz&quot; enclosed with double quotes, but the actual value is 'Fizz' enclosed with single quotes.
doctest treats these two as distinct, resulting in a failed test.</aside>
<aside class="notes">
ã“ã®ãƒ†ã‚¹ãƒˆã¯è½ã¡ã¦ã—ã¾ã„ã¾ã™ã€‚
æœŸå¾…å€¤ã¯ãƒ€ãƒ–ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆã§å›²ã¾ã‚ŒãŸFizzã€å®Ÿéš›ã®å€¤ã¯ã‚·ãƒ³ã‚°ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆã§å›²ã¾ã‚ŒãŸFizzã€‚
doctestã¯ã“ã®2ã¤ã‚’åˆ¥ç‰©ã¨ã—ã¦æ‰±ã†ã®ã§ã€ãƒ†ã‚¹ãƒˆãŒè½ã¡ã¾ã™</aside>
</section>
<section >
<h3>ç„¦ç‚¹ï¼šå¯¾è©±ãƒ¢ãƒ¼ãƒ‰ã®å‡ºåŠ›çµæœã¨ã—ã¦ä¸€è‡´ã™ã‚‹ã‹</h3>
<ul class="simple">
<li><p>å¯¾è©±ãƒ¢ãƒ¼ãƒ‰ã§ã¯ <strong>æ–‡å­—åˆ—</strong> ã¯åŸºæœ¬ <strong>ã‚·ãƒ³ã‚°ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆ</strong> ã§å›²ã¾ã‚Œã‚‹</p></li>
</ul>
<pre data-id="id22"><code data-trim data-noescape class="pycon">&gt;&gt;&gt; &quot;Fizz&quot;
'Fizz'</code></pre>
<ul class="simple">
<li><p>doctestã§ã‚‚æ–‡å­—åˆ—ã¯ã‚·ãƒ³ã‚°ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆã«ã™ã‚‹å¿…è¦ãŒã‚ã‚‹</p></li>
</ul>
<aside class="notes">
The key takeaway is that doctest checks for matches against the interactive mode's output.
When you input a string enclosed with double quotes in interactive mode, the output will be enclosed with single quotes.
In doctest, strings should be enclosed with single quotes.</aside>
<aside class="notes">
ãƒã‚¤ãƒ³ãƒˆã¨ã—ã¦ã¯ã€doctestã¯å¯¾è©±ãƒ¢ãƒ¼ãƒ‰ã®å‡ºåŠ›çµæœã¨ã—ã¦ä¸€è‡´ã™ã‚‹ã‹ã‚’è¦‹ã¦ã„ã‚‹ã®ã§ã€ãã‚Œã‚’å¿µé ­ã«è€ƒãˆã‚‹ã¨ã„ã†ã“ã¨ã§ã™ã€‚
å¯¾è©±ãƒ¢ãƒ¼ãƒ‰ã§ãƒ€ãƒ–ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆã§å›²ã‚“ã æ–‡å­—åˆ—ã‚’å…¥åŠ›ã—ã¦ã‚‚ã€å‡ºåŠ›ã¯ã‚·ãƒ³ã‚°ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆå›²ã¿ã§ã™ã­ã€‚
doctestã§ã¯æ–‡å­—åˆ—ã¯ã‚·ãƒ³ã‚°ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆã«ã™ã‚‹å¿…è¦ãŒã‚ã‚‹</aside>
</section>
<section >
<h3>å¯¾è©±ãƒ¢ãƒ¼ãƒ‰ã¯ <code class="docutils literal notranslate"><span class="pre">repr</span></code> é–¢æ•°ã®è¿”ã‚Šå€¤</h3>
<blockquote>
<div><p>repr() é–¢æ•°ã¯ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ—ãƒªã‚¿ã«èª­ã‚ã‚‹ï¼ˆç•¥ï¼‰è¡¨ç¾ã‚’è¿”ã™ãŸã‚ã®ã‚‚ã®</p>
</div></blockquote>
<p><a class="reference external" href="https://docs.python.org/ja/3/tutorial/inputoutput.html#fancier-output-formatting">https://docs.python.org/ja/3/tutorial/inputoutput.html#fancier-output-formatting</a></p>
<aside class="notes">
There's a built-in function called repr.
You can think of the output in interactive examples as the return value of repr.</aside>
<aside class="notes">
reprã¨ã„ã†çµ„ã¿è¾¼ã¿é–¢æ•°ãŒã‚ã‚Šã¾ã™ã€‚
å¯¾è©±ä¾‹ã®å‡ºåŠ›ã¯ã€reprã®è¿”ã‚Šå€¤ã¨æ€ã£ã¦ã„ãŸã ã‘ã‚Œã°ã¨æ€ã„ã¾ã™</aside>
</section>
<section >
<h3><code class="docutils literal notranslate"><span class="pre">repr</span></code> é–¢æ•°ã®è¿”ã‚Šå€¤ã§ã‚ã‚‹ã“ã¨ã‚’åˆ©ç”¨ã—ãŸä¾‹ ğŸƒâ€â™‚ï¸ (skip)</h3>
<pre data-id="repr-skip"><code data-trim data-noescape class="python">class Awesome:
    &quot;&quot;&quot;
    &gt;&gt;&gt; Awesome(&quot;PyCon APAC&quot;)
    Awesome('PyCon APAC')
    &quot;&quot;&quot;

    def __init__(self, string: str) -&gt; None:
        self.string = string

    def __repr__(self) -&gt; str:
        return f&quot;{self.__class__.__name__}({self.string!r})&quot;
</code></pre>
<p>ï¼ˆã‚¯ãƒ©ã‚¹ã®docstringã§doctestã®ä¾‹ã«ã‚‚ãªã£ã¦ã¾ã™ï¼‰</p>
</section>
</section>
<section>
<section >
<h2>doctestã‹ã‚‰è¦‹ã‚‹ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã®æ§‹æˆè¦ç´ </h2>
<pre data-id="id23"><code data-trim data-noescape class="python">def fizzbuzz(number: int) -&gt; str:
    &quot;&quot;&quot;FizzBuzzã‚²ãƒ¼ãƒ ã‚’è§£ãé–¢æ•°

    &gt;&gt;&gt; fizzbuzz(3)
    'Fizz'
    &quot;&quot;&quot;
</code></pre>
<ul class="simple">
<li><p>å®Ÿè¡Œä¾‹ã‚’æ›¸ãã ã‘ã§ã€é–¢æ•°ã« <strong>ã‚ã‚‹å€¤ã‚’å…¥åŠ›ã—ãŸã¨ãã®å‡ºåŠ›</strong> ã‚’æ¤œè¨¼ã§ããŸ</p></li>
<li><p><em>3A</em> ã¨ã„ã†è¦‹æ–¹ã‚’å°å…¥</p></li>
</ul>
<aside class="notes">
Shifting gears to another topic: components of test codes from doctest examples.
By just writing the interactive example, we can verify the output of the function, given certain value.
Here, I'd like to introduce the 3A approach.</aside>
<aside class="notes">
åˆ¥ã®è©±é¡Œã€doctestã‹ã‚‰è¦‹ã‚‹ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã®æ§‹æˆè¦ç´ 
å®Ÿè¡Œä¾‹ã‚’æ›¸ãã ã‘ã§ã€é–¢æ•°ã«ã‚ã‚‹å€¤ã‚’å…¥åŠ›ã—ãŸã¨ãã®å‡ºåŠ›ã‚’æ¤œè¨¼ã§ãã¾ã—ãŸãŒã€
ã“ã“ã§3A(three A)ã¨ã„ã†è¦‹æ–¹ã‚’å°å…¥ã—ã¾ã™</aside>
</section>
<section >
<h3>3A</h3>
<ul class="simple">
<li><p>Arrange æº–å‚™</p></li>
<li><p>Act å®Ÿè¡Œ</p></li>
<li><p>Assert æ¤œè¨¼</p></li>
</ul>
<p><a class="reference external" href="https://xp123.com/articles/3a-arrange-act-assert/">https://xp123.com/articles/3a-arrange-act-assert/</a></p>
<aside class="notes">
The three A's stand for Arrange, Act, and Assert.</aside>
<aside class="notes">
3ã¤ã®Aã§ã—ã¦ã€Arrangeãƒ»Actãƒ»Assertã§ã™ã€‚</aside>
</section>
<section >
<h3>3Aã§è¦‹ã‚‹doctest</h3>
<p>â€»ã‚³ãƒ¡ãƒ³ãƒˆã‚’ä½¿ã£ã¦èª¬æ˜ã™ã‚‹ãŸã‚ã€å¯¾è©±ãƒ¢ãƒ¼ãƒ‰ã§ç¤ºã—ã¾ã™</p>
<pre data-id="adoctest"><code data-trim data-noescape class="pycon">&gt;&gt;&gt; number = 3
&gt;&gt;&gt; fizzbuzz(number)
'Fizz'</code></pre>
<aside class="notes">
To explain the 3A, I use interactive mode instead of using a docstring,</aside>
<aside class="notes">
docstringã§ã¯ãªãå¯¾è©±ãƒ¢ãƒ¼ãƒ‰ã‚’ä½¿ã£ã¦ã€3Aã¨ã¯ä½•ã‹ã‚’ç¤ºã—ã¦ã„ãã¾ã™</aside>
</section>
<section >
<h3>Arrange</h3>
<p>ãƒ†ã‚¹ãƒˆã® <strong>æº–å‚™</strong> ï¼ˆãƒ‡ãƒ¼ã‚¿ã®ç”¨æ„ãªã©ï¼‰</p>
<pre data-id="arrange"><code data-trim data-noescape class="pycon" data-line-numbers="1">&gt;&gt;&gt; number = 3
&gt;&gt;&gt; fizzbuzz(number)
'Fizz'</code></pre>
<aside class="notes">
'Arrange' is about setting up for the test.
In this case, we just assign 3 to the variable number.</aside>
<aside class="notes">
Arrangeã¯ãƒ†ã‚¹ãƒˆã®æº–å‚™ã§ã™ã€‚ã“ã“ã§ã¯ç°¡å˜ã§ã™ãŒã€numberå¤‰æ•°ã«3ã‚’ä»£å…¥ã—ã¾ã—ãŸ</aside>
</section>
<section >
<h3>Act</h3>
<p>ãƒ†ã‚¹ãƒˆå¯¾è±¡ã®é–¢æ•°ã‚’ <strong>å®Ÿè¡Œ</strong></p>
<pre data-id="act"><code data-trim data-noescape class="pycon" data-line-numbers="2">&gt;&gt;&gt; number = 3
&gt;&gt;&gt; fizzbuzz(number)
'Fizz'</code></pre>
<aside class="notes">
'Act' refers to executing the function being tested.
We pass number to the fizzbuzz function.</aside>
<aside class="notes">
ãƒ†ã‚¹ãƒˆå¯¾è±¡ã®é–¢æ•°ã®å®Ÿè¡ŒãŒAct
numberã‚’fizzbuzzé–¢æ•°ã«æ¸¡ã™</aside>
</section>
<section >
<h3>Assert</h3>
<p>å®Ÿè¡ŒçµæœãŒæœŸå¾…å€¤ã¨ç­‰ã—ã„ã‹ã‚’ <strong>æ¤œè¨¼</strong></p>
<pre data-id="assert"><code data-trim data-noescape class="pycon" data-line-numbers="3">&gt;&gt;&gt; number = 3
&gt;&gt;&gt; fizzbuzz(number)
'Fizz'</code></pre>
<aside class="notes">
'Assert' is about verifying if the returned value matches the expected.
When writing tests, I always keep these 3A in mind.</aside>
<aside class="notes">
è¿”ã‚Šå€¤ãŒæœŸå¾…å€¤ã¨ä¸€è‡´ã™ã‚‹ã‹ã‚’æ¤œè¨¼ã™ã‚‹ã®ãŒAssert
ã“ã®3Aã‚’ãƒ†ã‚¹ãƒˆã‚’æ›¸ãã¨ãã«æ„è­˜ã—ã¦ã„ã¾ã™ã€‚</aside>
</section>
<section >
<h3>ç¬¬4ã®Aï¼šAnnihilate ğŸƒâ€â™‚ï¸ (skip)</h3>
<ul class="simple">
<li><p>ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—</p></li>
<li><p>ã€<a class="reference external" href="https://www.oreilly.co.jp/books/9784814400171/">ãƒ­ãƒã‚¹ãƒˆPython</a>ã€ç¬¬21ç« ã‚ˆã‚Š</p></li>
</ul>
</section>
</section>
<section >
<h2>ğŸ¥Ÿdoctest ã¾ã¨ã‚</h2>
<ul class="simple">
<li><p>å¯¾è©±ãƒ¢ãƒ¼ãƒ‰ã® <strong>å®Ÿè¡Œä¾‹ã‚’ã€docstringã«æ›¸ãã ã‘</strong>ï¼</p></li>
<li><p><strong class="command">python -m doctest</strong> ã«Pythonãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¸¡ã—ã¦ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</p></li>
<li><p>ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã®ä¸€æ­©ç›®ã¨ã—ã¦éå¸¸ã«ã‚ªã‚¹ã‚¹ãƒ¡ã§ã™</p></li>
</ul>
<aside class="notes">
To summarize doctest:
You can test by writing the interactive mode's example in the docstring!
The command is python -m doctest.
If you're thinking of trying your hand at writing test codes, I believe doctest is the easiest place to start.</aside>
<aside class="notes">
doctestã‚’ã¾ã¨ã‚ã¾ã™ã¨
å¯¾è©±ãƒ¢ãƒ¼ãƒ‰ã®å®Ÿè¡Œä¾‹ã‚’ã€docstringã«æ›¸ãã ã‘ã§ã€ãƒ†ã‚¹ãƒˆã§ãã¡ã‚ƒã†ï¼
ã‚³ãƒãƒ³ãƒ‰ã¯python -m doctestã§ã™ã€‚
ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ã¿ã‚ˆã†ã¨æ€ã£ãŸã‚‰doctestãŒä¸€ç•ªæ›¸ãã‚„ã™ã„ã¨æ€ã„ã¾ã™</aside>
</section>
<section>
<section >
<h2>é–‘è©±ä¼‘é¡ŒğŸµ ãŠå‰ã€èª°ã‚ˆ ç¶š</h2>
<p>é–¢ã‚ã£ã¦ã„ã‚‹ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã® <strong>ãƒã‚¹ã‚¿ãƒ¼</strong> &#64;20F</p>
<ul class="simple">
<li><p>Start Python Club (#stapy)</p></li>
<li><p>èª­æ›¸py</p></li>
</ul>
<aside class="notes">
This is a slide for a break.ï¼ˆçµ¦æ°´ï¼‰
I hope to see you at the poster session on the 20th floor!</aside>
<aside class="notes">
breakã®ã‚¹ãƒ©ã‚¤ãƒ‰ã§ã™ï¼ˆçµ¦æ°´ã™ã‚‹ï¼‰
20Fã®ãƒã‚¹ã‚¿ãƒ¼ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§ã‚‚ãŠä¼šã„ã—ã¾ã—ã‚‡ã†ï¼</aside>
</section>
<section >
<h3>ãŠå“æ›¸ã</h3>
<ol class="arabic simple">
<li><p>ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ãŒæ›¸ã‘ã‚‹ãƒ¡ãƒªãƒƒãƒˆ</p></li>
<li><p>doctestã®ä½¿ã„æ–¹</p></li>
<li><p><strong>pytestã®ä½¿ã„æ–¹</strong></p></li>
</ol>
<p>ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã‚’ã©ã†æ›¸ãã‹ Part 2/2</p>
<aside class="notes">
This is the final part.
I will introduce another method called pytest.
ğŸ™‹â€â™‚ï¸ Is anyone familiar with the name &quot;pytest&quot;?</aside>
<aside class="notes">
æœ€å¾Œã®ãƒ‘ãƒ¼ãƒˆã§ã™ã€‚
ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã‚’ã©ã†æ›¸ãã‹ã«å¯¾ã—ã¦ã€pytestã¨ã„ã†åˆ¥ã®ã‚„ã‚Šæ–¹ã‚’ç´¹ä»‹ã—ã¦ã„ãã¾ã™ã€‚
ğŸ™‹â€â™‚ï¸pytestã¨ã„ã†åç§°ã‚’èã„ãŸã“ã¨ãŒã‚ã‚‹æ–¹ï¼Ÿ</aside>
</section>
</section>
<section >
<h2>pytest</h2>
<ul class="simple">
<li><p>ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ©ã‚¤ãƒ–ãƒ©ãƒª <a class="reference external" href="https://pypi.org/project/pytest/">https://pypi.org/project/pytest/</a></p></li>
<li><p><strong class="command">pip install pytest</strong></p></li>
<li><p>ãƒ’ãƒŸãƒ„ï¼šå¤ãã¯ py.test ã ã£ãŸï¼ˆ<a class="reference external" href="https://github.com/pytest-dev/pytest/issues/1629">Issue#1629</a>ï¼‰</p></li>
</ul>
<aside class="notes">
pytest is a third-party library, and it might be fair to say it's the de facto standard.
You can use it after installing it with pip.</aside>
<aside class="notes">
pytestã¯ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã€ãƒ‡ãƒ•ã‚¡ã‚¯ãƒˆã‚¹ã‚¿ãƒ³ãƒ€ãƒ¼ãƒ‰ã¨è¨€ãˆã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚
pip installã—ã¦ä½¿ã£ã¦ã„ãã¾ã™ã€‚</aside>
</section>
<section>
<section >
<h2>pytestã§æ›¸ããƒ†ã‚¹ãƒˆã¯ <strong>3</strong> ã‚¹ãƒ†ãƒƒãƒ—</h2>
<ol class="arabic simple">
<li><p>ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã‚‹</p></li>
<li><p>ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã¨ã—ã¦ã€é–¢æ•°ã‚’æ›¸ã</p></li>
<li><p>assertæ–‡</p></li>
</ol>
<aside class="notes">
As for how to use pytest, there are three main steps.
Let's go over each one.</aside>
<aside class="notes">
pytestã‚’ã©ã†ä½¿ã†ã‹ã§ã™ãŒã€3ã¤ã®æ‰‹é †ã‚’ã‚„ã‚Œã°ã‚ˆã„ã§ã™ã€‚
1ã¤ãšã¤è¦‹ã¦ã„ãã¾ã—ã‚‡ã†ã€‚</aside>
</section>
<section >
<h3>Step1 pytestã®è¦å‰‡ã«å¾“ã£ãŸ <strong>ãƒ•ã‚¡ã‚¤ãƒ«</strong></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">test_</span></code> ã§å§‹ã¾ã‚‹Pythonãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ</p></li>
</ul>
<pre data-id="step1-pytest"><code data-trim data-noescape class="txt">.
â”œâ”€â”€ fizzbuzz.py
â””â”€â”€ test_fizzbuzz.py</code></pre>
<aside class="notes">
First, create a file following the pytest naming conventions.
Please create a Python file that starts with test_(underscore)</aside>
<aside class="notes">
ã¾ãšã€pytestã®è¦å‰‡ã«å¾“ã£ãŸåå‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã‚Šã¾ã™ã€‚
test_ ã§å§‹ã¾ã‚‹Pythonãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã£ã¦ãã ã•ã„</aside>
</section>
<section >
<h3>Step2 pytestã®è¦å‰‡ã«å¾“ã£ãŸ <strong>é–¢æ•°</strong></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">test_</span></code> ã§å§‹ã¾ã‚‹é–¢æ•°ã‚’æ›¸ã</p></li>
</ul>
<div class="literal-block-wrapper docutils container" id="id47">
<div class="code-block-caption"><span class="caption-text">test_fizzbuzz.py</span></div>
<pre><code data-trim data-noescape class="python">def test_3ã®å€æ•°ã®ã¨ãã¯Fizzã‚’è¿”ã™():
    ...</code></pre>
</div>
<aside class="notes">
Next, inside the file starting with test_(underscore), you'll write functions that also start with test_.
This might be a personal preference, but I believe it's okay to use Japanese in the function names.</aside>
<aside class="notes">
æ¬¡ã« test_ ã§å§‹ã¾ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­ã« test_ ã§å§‹ã¾ã‚‹é–¢æ•°ã‚’æ›¸ãã¾ã™ã€‚
ç§ã®æ„è¦‹ã§ã™ãŒã€é–¢æ•°åã¯æ—¥æœ¬èªã‚’ä½¿ã£ã¦ã‚‚ã‚ˆã„ã¨æ€ã„ã¾ã™</aside>
</section>
<section >
<h3>Step3 Pythonã® <strong>assertæ–‡</strong></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">assert</span> <span class="pre">å¼</span></code></p></li>
<li><p>å¼ãŒ <code class="docutils literal notranslate"><span class="pre">True</span></code> ã¨è©•ä¾¡ã•ã‚Œã‚‹ã‹ã‚’æ¤œè¨¼</p></li>
</ul>
<p><a class="reference external" href="https://docs.python.org/ja/3/reference/simple_stmts.html#the-assert-statement">https://docs.python.org/ja/3/reference/simple_stmts.html#the-assert-statement</a></p>
<aside class="notes">
The contents of these functions will make use of the assert statement.
Place an expression after the assert keyword.
It will verify if the expression is evaluated as True.
Let's see an example.</aside>
<aside class="notes">
é–¢æ•°ã®å†…å®¹ã§ã™ãŒã€assertæ–‡ã‚’ä½¿ã„ã¾ã™ã€‚
assertã¨ã„ã†ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã®å¾Œã«å¼ã‚’ç½®ãã ã‘ã¾ã™ã€‚
å¼ãŒ True ã¨è©•ä¾¡ã•ã‚Œã‚‹ã‹ã‚’æ¤œè¨¼ã—ã¾ã™ã€‚
ä¾‹ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†</aside>
</section>
<section >
<h3>assertæ–‡ã®ä¾‹ 1/2</h3>
<pre data-id="assert-1-2"><code data-trim data-noescape class="pycon">&gt;&gt;&gt; 1 == 1
True
&gt;&gt;&gt; assert 1 == 1</code></pre>
<aside class="notes">
If you set the expression as 1 equals 1, since it's True, nothing will be displayed.</aside>
<aside class="notes">
å¼ãŒ 1 ã‚¤ã‚³ãƒ¼ãƒ« 1 ã¨ç½®ãã¨ã€ã“ã‚Œã¯Trueãªã®ã§ä½•ã‚‚è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ã€‚</aside>
</section>
<section >
<h3>assertæ–‡ã®ä¾‹ 2/2</h3>
<pre data-id="assert-2-2"><code data-trim data-noescape class="pycon">&gt;&gt;&gt; 1 == 2
False
&gt;&gt;&gt; assert 1 == 2
Traceback (most recent call last):
  File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;
AssertionError</code></pre>
<aside class="notes">
On the other hand, if you set the expression as 1 equals 2,
it's evaluated as False, and an AssertionError will be raised.
Using the above steps, you'll write tests with pytest.</aside>
<aside class="notes">
åˆ¥ã®ä¾‹ã§ 1 ã‚¤ã‚³ãƒ¼ãƒ« 2 ã¨ã„ã†å¼ã¯Falseã¨è©•ä¾¡ã•ã‚Œã‚‹ã®ã§ã€AssertionErrorãŒé€å‡ºã•ã‚Œã¾ã™ã€‚
ä»¥ä¸Šã®è¦ç´ ã‚’ä½¿ã£ã¦pytestã®ãƒ†ã‚¹ãƒˆã‚’æ›¸ãã¾ã™ã€‚</aside>
</section>
<section >
<h3>3Aã§ã¨ã‚‰ãˆã‚‹pytest</h3>
<div class="literal-block-wrapper docutils container" id="id48">
<div class="code-block-caption"><span class="caption-text">test_fizzbuzz.py</span></div>
<pre><code data-trim data-noescape class="python">def test_3ã®å€æ•°ã®ã¨ãã¯Fizzã‚’è¿”ã™():
    number = 3  # Arrange
      # Act &amp; Assert (actual == expected)
    assert fizzbuzz(number) == &quot;Fizz&quot;</code></pre>
</div>
<aside class="notes">
Here's a test verifying that Fizz is returned for multiples of 3.
We write the 3A within a function.
There's a line for 'Arrange',
and 'Act' and 'Assert' are combined into a single line.</aside>
<aside class="notes">
ã“ã‚Œã¯3ã®å€æ•°ã®ã¨ãã«FizzãŒè¿”ã‚‹ã‹ã‚’æ¤œè¨¼ã™ã‚‹ãƒ†ã‚¹ãƒˆã§ã™ã€‚
1ã¤ã®é–¢æ•°ã®ä¸­ã§3Aã‚’è¡Œã„ã¾ã™ã€‚
Arrangeã®è¡ŒãŒã‚ã‚Šã€
Actã¨Assertã¯1ã¤ã®è¡Œã«ã¾ã¨ã¾ã£ã¦ã„ã¾ã™ã€‚</aside>
</section>
<section >
<h3>ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ <strong class="command">pytest -v</strong></h3>
<pre data-id="pytest-v"><code data-trim data-noescape class="default">.
â”œâ”€â”€ fizzbuzz.py
â””â”€â”€ test_fizzbuzz.py</code></pre>
<pre data-id="pytest-v"><code data-trim data-noescape class="shell">$ pytest -v
============================= test session starts ==============================

collected 5 items

============================== 5 passed in 0.01s ===============================</code></pre>
<aside class="notes">
Put the implementation file and the test file,
then run the tests using the pytest -v command.
In this case, all the tests have passed.</aside>
<aside class="notes">
fizzbuzzã®å®Ÿè£…ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¨ãƒ†ã‚¹ãƒˆã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é…ç½®ã—ã€pytest -v ã‚³ãƒãƒ³ãƒ‰ã§ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
ã“ã‚Œã¯ãƒ†ã‚¹ãƒˆãŒå…¨ã¦passã—ã¦ã„ã¾ã™</aside>
</section>
<section >
<h3>failã—ãŸãƒ†ã‚¹ãƒˆï¼ˆ15ã§Fizzã‚’è¿”ã—ãŸï¼‰</h3>
<pre data-id="fail-15fizz"><code data-trim data-noescape class="shell">test_fizzbuzz.py::test_15ã®å€æ•°ã®ã¨ãã¯FizzBuzzã‚’è¿”ã™ FAILED             [ 20%]

=================================== FAILURES ===================================
__________________________ test_15ã®å€æ•°ã®ã¨ãã¯FizzBuzzã‚’è¿”ã™ ___________________________

    def test_15ã®å€æ•°ã®ã¨ãã¯FizzBuzzã‚’è¿”ã™():
&gt;       assert fizzbuzz(15) == &quot;FizzBuzz&quot;
E       AssertionError: assert 'Fizz' == 'FizzBuzz'
E         - FizzBuzz
E         + Fizz</code></pre>
<ul class="simple">
<li><p>assertæ–‡ã ãŒã€ <strong>ãªãœAssertionErrorã‹ãŒåˆ†ã‹ã‚Šã‚„ã™ã„</strong></p></li>
</ul>
<aside class="notes">
Let's deliberately make one test fail.
Isn't the output very clear? Thanks to pytest -v.
About AssertionError, you can easily see where the issue lies, such as expecting FizzBuzz but the actual value is Fizz.</aside>
<aside class="notes">
è©¦ã—ã«å¤±æ•—ã•ã›ã¦ã¿ã¾ã—ã‚‡ã†ã€‚
ã¨ã¦ã‚‚ã‚ã‹ã‚Šã‚„ã™ããªã„ã§ã™ã‹ï¼Ÿ pytest -vã®ãŠã‹ã’ã§ã™ã€‚
AssertionErrorã«ã¤ã„ã¦ã‚‚ã€æœŸå¾…å€¤ãŒFizzBuzzã ãŒå®Ÿéš›ã®å€¤ã¯Fizzã¨ã€ã©ã“ãŒé–“é•ã£ã¦ã„ã‚‹ã‹ä¸€ç›®ç­ç„¶ã§ã™ã€‚</aside>
</section>
<section >
<h3>pytestã¯ <strong>assertæ–‡ã‚’æ‹¡å¼µ</strong></h3>
<ul class="simple">
<li><p>ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã«ä½¿ã†ã®ã¯assertæ–‡ã ã‘ã¨ <strong>ç°¡å˜</strong></p></li>
<li><p>failã—ãŸãƒ†ã‚¹ãƒˆã®ç†ç”±ãŒ <strong>åˆ†ã‹ã‚Šã‚„ã™ã„</strong></p>
<ul>
<li><p>ç§˜å¯†ã¯ <em>pytestãŒassertæ–‡ã‚’æ›¸ãæ›ãˆ</em> ã¦ã„ã‚‹ï¼ˆ<a class="reference external" href="https://docs.pytest.org/en/latest/how-to/writing_plugins.html#assertion-rewriting">assertion rewriting</a>ï¼‰</p></li>
</ul>
</li>
</ul>
<aside class="notes">
What brings such clarity?
All we have to write are the assert statements.
Behind the scenes, pytest works hard to provide very understandable reasons when tests fail.
This is one of the features of pytest.</aside>
<aside class="notes">
ãªãœã“ã‚“ãªã“ã¨ãŒã§ãã‚‹ã‹ã¨ã„ã†ã¨
äººãŒæ›¸ãã®ã¯assertæ–‡ã ã‘ã§ã™ã€‚
è£ã§pytestãŒé ‘å¼µã£ã¦ãã‚Œã¦ã„ã¦ã€failã—ãŸãƒ†ã‚¹ãƒˆã®ç†ç”±ãŒã¨ã¦ã‚‚ã‚ã‹ã‚Šã‚„ã™ã„ã§ã™ã€‚
pytestã®ç‰¹å¾´ã®1ã¤ã§ã™</aside>
</section>
<section >
<h3>pytestã§ <strong>docstringã®å¯¾è©±ä¾‹ã‚‚</strong> å®Ÿè¡Œã§ãã‚‹ğŸƒâ€â™‚ï¸</h3>
<ul class="simple">
<li><p><strong class="command">pytest --doctest-modules</strong></p></li>
<li><p><a class="reference external" href="https://docs.pytest.org/en/stable/how-to/doctest.html">https://docs.pytest.org/en/stable/how-to/doctest.html</a></p></li>
</ul>
<aside class="notes">
You can also run the interactive examples inside the docstring,
so there's no need to rewrite tests you've created using doctest!</aside>
<aside class="notes">
docstringä¸­ã®å¯¾è©±ä¾‹ã‚‚å®Ÿè¡Œã§ãã‚‹ã®ã§ã€doctestã§æ›¸ã„ãŸãƒ†ã‚¹ãƒˆã‚’æ›¸ãç›´ã™å¿…è¦ã‚‚ãªã„ã§ã™ï¼</aside>
</section>
</section>
<section>
<section >
<h2>tips (1/2) ãƒ‘ãƒ©ãƒ¡ã‚¿åŒ–ãƒ†ã‚¹ãƒˆ</h2>
<pre data-id="tips-1-2"><code data-trim data-noescape class="python">def test_3ã®å€æ•°ã®ã¨ãã¯Fizzã‚’è¿”ã™():
    ...</code></pre>
<aside class="notes">
As a tip, I'd like to introduce parameterized tests.
We want to check if Fizz is returned for multiples of 3.</aside>
<aside class="notes">
tipsã¨ã—ã¦ãƒ‘ãƒ©ãƒ¡ã‚¿åŒ–ãƒ†ã‚¹ãƒˆã‚’ç´¹ä»‹ã—ã¾ã™ã€‚
3ã®å€æ•°ã®ã¨ãã«Fizzã‚’è¿”ã™ãƒ†ã‚¹ãƒˆã§ã™ãŒ</aside>
</section>
<section >
<h3>3ã®å€æ•°ãªã‚‰Fizz</h3>
<p><code class="docutils literal notranslate"><span class="pre">number</span></code> ã® <strong>å–ã‚Šã†ã‚‹å€¤ã¯è¤‡æ•°</strong></p>
<ul class="simple">
<li><p>3</p></li>
<li><p>6</p></li>
<li><p>9</p></li>
</ul>
<aside class="notes">
There are many values that are multiples of 3.
Among these, let's say we want to test for the cases of 3 and 6.</aside>
<aside class="notes">
3ã®å€æ•°ã®å€¤ã¯è¤‡æ•°ã‚ã‚Šã¾ã™ã€‚
ãã®ä¸­ã§3ã¨6ã®ã‚±ãƒ¼ã‚¹ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ã¨ã—ã¾ã™</aside>
</section>
<section >
<h3>å€‹åˆ¥ã«ãƒ†ã‚¹ãƒˆã®é–¢æ•°ã‚’æ›¸ãï¼Ÿ</h3>
<pre data-id="id28"><code data-trim data-noescape class="python">def test_3ã®å€æ•°ã®ã¨ãã¯Fizzã‚’è¿”ã™_3ã®å ´åˆ():
    ...

def test_3ã®å€æ•°ã®ã¨ãã¯Fizzã‚’è¿”ã™_6ã®å ´åˆ():
    ...</code></pre>
<aside class="notes">
Would you write separate tests for each?
While you can, it's always nice to find a more efficient way.</aside>
<aside class="notes">
ã§ã¯å€‹åˆ¥ã«ãƒ†ã‚¹ãƒˆã‚’æ›¸ãã®ã§ã—ã‚‡ã†ã‹ï¼Ÿ
æ›¸ã„ã¦ã‚‚ã„ã„ã§ã™ãŒã€æ¥½ã¯ã—ãŸã„ã§ã™ã‚ˆã­</aside>
</section>
<section >
<h3><code class="docutils literal notranslate"><span class="pre">&#64;pytest.mark.parametrize</span></code> ã‚’ä½¿ãŠã†</h3>
<pre data-id="pytest-mark-parametrize"><code data-trim data-noescape class="python">&#64;pytest.mark.parametrize(&quot;number&quot;, [3, 6])
def test_3ã®å€æ•°ã®ã¨ãã¯Fizzã‚’è¿”ã™(number):
    assert fizzbuzz(number) == &quot;Fizz&quot;
</code></pre>
<aside class="notes">
To streamline the process, there's a decorator called pytest.mark.parametrize.</aside>
<aside class="notes">
æ¥½ã‚’ã™ã‚‹ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã¨ã—ã¦ pytest.mark.parametrize ã¨ã„ã†ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã™</aside>
</section>
<section >
<h3>1ã¤ã®é–¢æ•°ã€è¤‡æ•°ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹</h3>
<pre data-id="id29"><code data-trim data-noescape class="shell">$ pytest -v

test_fizzbuzz.py::test_3ã®å€æ•°ã®ã¨ãã¯Fizzã‚’è¿”ã™[3] PASSED               [ 40%]
test_fizzbuzz.py::test_3ã®å€æ•°ã®ã¨ãã¯Fizzã‚’è¿”ã™[6] PASSED               [ 60%]</code></pre>
<p><strong>å€‹åˆ¥ã«æ›¸ã„ãŸã®ã¨åŒã˜</strong> çµæœãŒå¾—ã‚‰ã‚Œã‚‹</p>
<aside class="notes">
By using this decorator, a single function is treated as if it has multiple test cases.
This means, for this example, there are two test cases, one for 3 and another for 6.
The outcome is the same as if you had written them separately.</aside>
<aside class="notes">
ã“ã®ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã‚’ä½¿ã†ã¨ã€1ã¤ã®é–¢æ•°ã ãŒãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã¨ã—ã¦ã¯è¤‡æ•°ã‚ã‚‹ã¨ã—ã¦æ‰±ã‚ã‚Œã¾ã™ã€‚
3ã®ã‚±ãƒ¼ã‚¹ã¨6ã®ã‚±ãƒ¼ã‚¹ã¨2å€‹åˆ†ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ãŒã‚ã‚‹ã¨ã„ã†ã“ã¨ã§ã™ã€‚
å€‹åˆ¥ã«æ›¸ã„ãŸã®ã¨åŒã˜çµæœã§ã™</aside>
</section>
</section>
<section>
<section >
<h2>tips (2/2) ãƒ¢ãƒƒã‚¯</h2>
<p>ã‚„ã‚„ç™ºå±•çš„è©±é¡Œï¼ˆã„ã¾ã¯åˆ†ã‹ã‚‰ãªã‹ã£ãŸã¨ã—ã¦ã‚‚å¤§ä¸ˆå¤«ï¼‰</p>
<aside class="notes">
Another tip, which might be advanced and may feel difficult, is the concept of &quot;mock&quot;.</aside>
<aside class="notes">
ã‚‚ã†1ã¤ã®tipsã¨ã—ã¦ã¯ã€ç™ºå±•çš„ãªã®ã§é›£ã—ã‹ã£ãŸã€œã¨ã—ã¦ã‚‚å¤§ä¸ˆå¤«ã§ã™ãŒã€
ãƒ¢ãƒƒã‚¯ã¨ã„ã†æ¦‚å¿µãŒã‚ã‚Šã¾ã™</aside>
</section>
<section >
<h3>è¤‡æ•°ã®å‡¦ç†ã‚’å‘¼ã³å‡ºã™å®Ÿè£…ã®ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã</h3>
<ul class="simple">
<li><p>ãƒ†ã‚¹ãƒˆã‚’æ›¸ããŸã„é–¢æ•° <code class="docutils literal notranslate"><span class="pre">foo</span></code></p></li>
<li><p>å‡¦ç†A -&gt; B -&gt; Cã®é †ã§å‘¼ã³å‡ºã—</p></li>
</ul>
<pre data-id="id30"><code data-trim data-noescape class="python">def foo():
    a_func(42)
    b_func(&quot;ham&quot;, &quot;egg&quot;)
    c_func()
</code></pre>
<aside class="notes">
How would you test a function that sequentially calls other functions?</aside>
<aside class="notes">
ã‚ã‚‹é–¢æ•°ã®ä¸­ã§åˆ¥ã®é–¢æ•°ã‚’é †ç•ªã«å‘¼ã³å‡ºã™å ´åˆã¯ã©ã†ãƒ†ã‚¹ãƒˆã—ã¾ã—ã‚‡ã†ï¼Ÿ</aside>
</section>
<section >
<h3>ã©ã†ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãã‹ï¼Ÿ</h3>
<ul class="simple">
<li><p>æ¨ã—ï¼šå‘¼ã³å‡ºã•ã‚Œã‚‹å‡¦ç†ã‚’ <strong>ãƒ‹ã‚»ãƒ¢ãƒï¼ˆï¼ãƒ¢ãƒƒã‚¯ï¼‰ã«ç½®ãæ›ãˆ</strong> ã¦ãƒ†ã‚¹ãƒˆ</p></li>
<li><p>å…¨ã¦ã®å‡¦ç†ã‚’é€šã—ãŸãƒ†ã‚¹ãƒˆã‚‚æ›¸ã‘ã‚‹</p></li>
</ul>
<aside class="notes">
In my opinion, you would replace the called processes with fakes when testing.
These fakes are called &quot;mocks&quot;.</aside>
<aside class="notes">
ç§ã®æ„è¦‹ã¨ã—ã¦ã¯ã€å‘¼ã³å‡ºã•ã‚Œã‚‹å‡¦ç†ã‚’å½ç‰©ã«ç½®ãæ›ãˆã¦ãƒ†ã‚¹ãƒˆã—ã¾ã™ã€‚
ã“ã®å½ç‰©ãŒãƒ¢ãƒƒã‚¯ã§ã™</aside>
</section>
<section >
<h3>ãƒ¢ãƒƒã‚¯ã‚’ä½¿ã£ãŸãƒ†ã‚¹ãƒˆ</h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">foo</span></code> é–¢æ•°ã§å‘¼ã³å‡ºã™å„å‡¦ç†ã‚’ãƒ†ã‚¹ãƒˆã«ãŠã„ã¦ <em>ä½•ã‚‚ã—ãªã„</em> ï¼ˆï¼ãƒ¢ãƒƒã‚¯ï¼‰ã«ç½®ãæ›ãˆã‚‹</p></li>
<li><p><strong>ãƒ¢ãƒƒã‚¯ã¯å‘¼ã³å‡ºã•ã‚Œæ–¹ã‚’è¨˜æ†¶</strong> ã—ã¦ã„ã‚‹</p></li>
</ul>
<aside class="notes">
Mocks can be called, but they don't execute the actual functions.
They remember how they were called.</aside>
<aside class="notes">
ãƒ¢ãƒƒã‚¯ã¯å‘¼ã³å‡ºã›ã‚‹ãŒã€æœ¬ç‰©ã®é–¢æ•°ã®å‡¦ç†ã¯ã—ã¾ã›ã‚“ã€‚
ã©ã†ã„ã†ãµã†ã«å‘¼ã³å‡ºã•ã‚ŒãŸã‹ã‚’è¦šãˆã¦ã„ã¾ã™</aside>
</section>
<section >
<h3>ãƒ¢ãƒƒã‚¯ã‚’ä½¿ã£ãŸãƒ†ã‚¹ãƒˆã®ä¾‹</h3>
<pre data-id="id33"><code data-trim data-noescape class="python">&#64;patch(&quot;test_with_mock.c_func&quot;)
&#64;patch(&quot;test_with_mock.b_func&quot;)
&#64;patch(&quot;test_with_mock.a_func&quot;)
def test_foo(a_func, b_func, c_func):
    foo()

    a_func.assert_called_once_with(42)
    b_func.assert_called_once_with(&quot;ham&quot;, &quot;egg&quot;)
    c_func.assert_called_once_with()
</code></pre>
<ul class="simple">
<li><p>å‡¦ç†ã® <strong>å‘¼ã³å‡ºã—ã‚’æ¤œè¨¼</strong></p></li>
<li><p>å‡¦ç†A,B,Cè‡ªä½“ã¯ã„ãšã‚Œã‚‚åˆ¥é€”ã€å¾¹åº•çš„ã«æ¤œè¨¼</p></li>
</ul>
<aside class="notes">
While it might be overwhelming when you first encounter it,
the function a_func is mocked and the actual a_func isn't executed.
The test is only verifying that a_func is called with the argument 42(forty-two).
Additionally, each function that has been mocked is thoroughly verified within its respective test code.</aside>
<aside class="notes">
ã„ããªã‚Šç›®ã«ã™ã‚‹ã¨åœ§å€’ã•ã‚Œã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€
a_funcã¯ãƒ¢ãƒƒã‚¯ã§å®Ÿéš›ã«a_funcé–¢æ•°ã¯å®Ÿè¡Œã•ã‚Œã¾ã›ã‚“ã€‚
ãŸã ã“ã®é–¢æ•°ãŒ42ã‚’å¼•æ•°ã«å‘¼ã³å‡ºã•ã‚Œã‚‹ã“ã¨ã ã‘ã‚’æ¤œè¨¼ã—ã¦ã„ã¾ã™ã€‚
ã¾ãŸã€ãƒ¢ãƒƒã‚¯ã«ã—ãŸå„é–¢æ•°ã¯ãã‚Œãã‚Œã®ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã®ä¸­ã§å¾¹åº•çš„ã«æ¤œè¨¼ã—ã¦ã„ã¾ã™</aside>
</section>
<section >
<h3>ãƒ¢ãƒƒã‚¯ã®ä½¿ã„æ‰€</h3>
<ul class="simple">
<li><p>æ™‚é–“ã®ã‹ã‹ã‚‹é–¢æ•°ï¼ˆãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œæ™‚é–“ãŒä¼¸ã³ã‚‹ï¼‰</p></li>
<li><p>å¤–éƒ¨ã¨é€šä¿¡ã™ã‚‹é–¢æ•°ï¼ˆé€šä¿¡ã‚¨ãƒ©ãƒ¼ã§ãƒ†ã‚¹ãƒˆãŒè½ã¡ã†ã‚‹ï¼‰</p></li>
<li><p>å‡ºåŠ›ãŒå¤‰ã‚ã‚‹é–¢æ•°ï¼ˆä¾‹ï¼šrandomï¼‰</p></li>
</ul>
<aside class="notes">
From experience, I tend to use mocks for functions that take a long time,
functions that communicate externally, and functions where the output varies.</aside>
<aside class="notes">
çµŒé¨“ä¸Šãƒ¢ãƒƒã‚¯ã‚’ç©æ¥µçš„ã«ä½¿ã„ãŸã„ã®ã¯ã€æ™‚é–“ã®ã‹ã‹ã‚‹é–¢æ•°ã€å¤–éƒ¨ã¨é€šä¿¡ã™ã‚‹é–¢æ•°ã€å‡ºåŠ›ãŒå¤‰ã‚ã‚‹é–¢æ•°ã§ã™ã€‚</aside>
</section>
</section>
<section >
<h2>ğŸ¥Ÿpytest ã¾ã¨ã‚</h2>
<ul class="simple">
<li><p><strong>test_</strong> ã§å§‹ã¾ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ãƒ» <strong>test_</strong> ã§å§‹ã¾ã‚‹é–¢æ•°ãƒ» <strong>assertæ–‡</strong></p></li>
<li><p>tips: ãƒ‘ãƒ©ãƒ¡ã‚¿åŒ– &amp; ãƒ¢ãƒƒã‚¯</p></li>
<li><p>ãƒ†ã‚¹ãƒˆã«æ…£ã‚Œã¦ããŸã‚‰ãœã²è©¦ã—ã¦ã¿ã¦ãã ã•ã„ï¼</p></li>
</ul>
<aside class="notes">
To summarize pytest,
You write functions starting with test_ inside files that also start with test_,
and you use the assert statement.
two tips: parametrize and mock.
Once you get familiar with testing, give pytest a try. I think you'll find it easy to write.</aside>
<aside class="notes">
pytestã‚’ã¾ã¨ã‚ã‚‹ã¨
test_ã§å§‹ã¾ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã«test_ã§å§‹ã¾ã‚‹é–¢æ•°ã‚’æ›¸ã„ã¦ã€ä¸­ã§assertæ–‡ã‚’ä½¿ã„ã¾ã™ã€‚
ãƒ†ã‚¹ãƒˆã«æ…£ã‚Œã¦ããŸã‚‰è©¦ã—ã¦ã¿ã¦ãã ã•ã„ã€‚æ›¸ãã‚„ã™ã„ã¨æ€ã„ã¾ã™</aside>
</section>
<section>
<section >
<h2>ã¾ã¨ã‚ğŸŒ¯ ç·´ç¿’ã—ã¦ãƒ†ã‚¹ãƒˆã‚’æ›¸ã‘ã‚‹ã‚ˆã†ã«ãªã‚‹ã‚“ã </h2>
<ul class="simple">
<li><p>ãƒ†ã‚¹ãƒˆã‚’æ›¸ãã¨ã€å‹•ä½œã™ã‚‹ï¼Ÿ é–“é•ãˆã¦ãªã„ï¼Ÿã¨ã„ã†ä¸å®‰ã¯ <strong>é€€å±ˆ</strong> ã«å¤‰ã‚ã‚‹</p></li>
<li><p>é–¢æ•°ã®å‘¼ã³å‡ºã—ã¨è¿”ã‚Šå€¤ã‚’ <strong>docstringã«æ›¸ãã ã‘</strong> ã§ã€doctestã§ãƒ†ã‚¹ãƒˆã§ãã‚‹ï¼ï¼ˆä¸€æ­©ç›®ï¼‰</p></li>
<li><p>ï¼ˆæ‹¡å¼µã•ã‚ŒãŸï¼‰assertæ–‡ã‚’ã¯ã˜ã‚ã€ <strong>ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ãŒæ›¸ãã‚„ã™ã„pytest</strong> ã‚‚ãœã²ï¼</p></li>
</ul>
<aside class="notes">
To summarize:
Writing tests transforms the fear of &quot;Is it working? Did I make a mistake?&quot; into boredom.
I've introduced two methods:
The first, doctest, involves simply writing the function call and its return value in the docstring.
The second is pytest, which makes writing test code easier.
I encourage you to try out both of these approaches.</aside>
<aside class="notes">
ã¾ã¨ã‚ã¾ã™ã€‚
ãƒ†ã‚¹ãƒˆã‚’æ›¸ãã¨ã€å‹•ä½œã™ã‚‹ï¼Ÿ é–“é•ãˆã¦ãªã„ï¼Ÿã¨ã„ã†ä¸å®‰ã¯ **é€€å±ˆ** ã«å¤‰ã‚ã‚‹
ã‚„ã‚Šæ–¹ã‚’2ã¤ç´¹ä»‹ã—ã¾ã—ãŸã€‚
é–¢æ•°ã®å‘¼ã³å‡ºã—ã¨è¿”ã‚Šå€¤ã‚’docstringã«æ›¸ãã ã‘ã®doctestã€
ã‚‚ã†1å€‹ãŒãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ãŒæ›¸ãã‚„ã™ããªã‚‹pytestã€‚
ã“ã‚Œã‚‰ã‚’ãœã²ä½¿ã£ã¦ã¿ã¦ãã ã•ã„ã€‚</aside>
</section>
<section >
<h3>pytestã¯ã¾ã ã¾ã åºã®å£ğŸƒâ€â™‚ï¸ (skip)</h3>
<ul class="simple">
<li><p>ãƒ‘ãƒ©ãƒ¡ã‚¿åŒ–ãƒ†ã‚¹ãƒˆã‚’ç´¹ä»‹</p></li>
<li><p><em>ãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£</em></p></li>
<li><p>ã€<a class="reference external" href="https://www.shoeisha.co.jp/book/detail/9784798177458">ãƒ†ã‚¹ãƒˆé§†å‹•Python</a>ã€</p></li>
</ul>
</section>
<section >
<h3>ã”æ¸…è´ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸ</h3>
<p>å¥½ãã¨ã‹å«Œã„ã¨ã‹ã¯ã„ã„ã€ç·´ç¿’ã—ã¦ãƒ†ã‚¹ãƒˆã‚’æ›¸ã‘ã‚‹ã‚ˆã†ã«ãªã‚‹ã‚“ã </p>
<p>Practice, practice, practice!!!</p>
<aside class="notes">
Thank you for your listening</aside>
</section>
</section>
<section >
<h2>References</h2>
<ul>
<li><p>ã€<a class="reference external" href="https://www.ohmsha.co.jp/book/9784274217883/">ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™º</a>ã€ï¼ˆKent Beckï¼‰</p>
<blockquote>
<div><p>ãƒ†ã‚¹ãƒˆã¯ä¸å®‰ã‚’é€€å±ˆã«å¤‰ãˆã‚‹è³¢è€…ã®çŸ³ã ã€‚ï¼ˆç¬¬25ç« ï¼‰</p>
</div></blockquote>
</li>
<li><p>ã€<a class="reference external" href="https://gihyo.jp/book/2022/978-4-297-13234-7">ã¡ã‚‡ã†ãœã¤ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢è¨­è¨ˆå…¥é–€</a>ã€ï¼ˆç¬¬6ç« ï¼‰</p></li>
</ul>
</section>
<section >
<h2>Appendix</h2>
</section>
<section >
<h2>ãŠå‰ã€èª°ã‚ˆï¼ˆè©³ç´°ç‰ˆï¼‰</h2>
<ul class="simple">
<li><p><a class="reference external" href="https://pypi.org/project/sphinx-new-tab-link/">sphinx-new-tab-link</a> ãƒ» <a class="reference external" href="https://github.com/ftnext/hayasaka">hayasaka</a> ãªã©ã‚’é–‹ç™ºï¼ˆæ„Ÿæƒ³ãƒ»è¦æœ›ãƒ»ã‚¹ã‚¿ãƒ¼å¾…ã£ã¦ã¾ã™ï¼ï¼‰</p></li>
<li><p>æ¯æ—¥1ã‚¨ãƒ³ãƒˆãƒªç¶™ç¶šä¸­ <a class="reference external" href="https://nikkie-ftnext.hatenablog.com/">https://nikkie-ftnext.hatenablog.com/</a></p></li>
</ul>
</section>
<section>
<section >
<h2>è£œè¶³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„</h2>
</section>
<section >
<h3>ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ãŠã‘ã‚‹pytest</h3>
<ul class="simple">
<li><p>ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã¯ tests ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä¸‹ã«ã¾ã¨ã‚ã‚‹ã®ãŒä¸€èˆ¬çš„</p></li>
</ul>
<pre data-id="id40"><code data-trim data-noescape class="txt">.
â”œâ”€â”€ hayasaka
â””â”€â”€ tests
    â”œâ”€â”€ __init__.py
    â””â”€â”€ test_core.py</code></pre>
<p><a class="reference external" href="https://github.com/ftnext/hayasaka/tree/0.2.0">https://github.com/ftnext/hayasaka/tree/0.2.0</a></p>
</section>
<section >
<h3>ã‚¯ãƒ©ã‚¹ã‚‚æ›¸ã‘ã‚‹ãªã‚‰ã€pytestã§æ›¸ããƒ†ã‚¹ãƒˆã‚’ <strong>æ§‹é€ åŒ–</strong> ã§ãã‚‹</h3>
<pre data-id="id41"><code data-trim data-noescape class="python">class Test_FizzBuzzæ•°åˆ—ã¨å¤‰æ›è¦å‰‡ã‚’æ‰±ã†FizzBuzzã‚¯ãƒ©ã‚¹:
    class Test_convertãƒ¡ã‚½ãƒƒãƒ‰ã¯æ•°ã‚’æ–‡å­—åˆ—ã«å¤‰æ›ã™ã‚‹:
        class Test_3ã®å€æ•°ã®ã¨ãã¯æ•°ã®ä»£ã‚ã‚Šã«Fizzã«å¤‰æ›ã™ã‚‹:
            def test_3ã‚’æ¸¡ã™ã¨æ–‡å­—åˆ—Fizzã‚’è¿”ã™(self, fizzBuzz):
                assert &quot;Fizz&quot; == fizzBuzz.convert(3)</code></pre>
<p><a class="reference external" href="https://github.com/ftnext/tddbc-fizzbuzz/blob/8ea856c4c59780837410a44a858368047269f3c8/tests/test_fizzbuzz.py#L11-L15">https://github.com/ftnext/tddbc-fizzbuzz/blob/8ea856c4c59780837410a44a858368047269f3c8/tests/test_fizzbuzz.py#L11-L15</a></p>
</section>
<section >
<h3>15åˆ†ç‰ˆã§ã¯å‰²æ„›ã—ãŸã€æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒª unittest</h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">TestCase</span></code> ã‚¯ãƒ©ã‚¹ã‚’ç¶™æ‰¿</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">assertXXX</span></code> ãƒ¡ã‚½ãƒƒãƒ‰ã§Assert</p></li>
<li><p>ãƒ¢ãƒƒã‚¯ã¯ <a class="reference external" href="https://docs.python.org/ja/3/library/unittest.mock.html">unittest.mock</a> ã‹ã‚‰</p></li>
<li><p>æ‹™ãƒ–ãƒ­ã‚° <a class="reference external" href="https://nikkie-ftnext.hatenablog.com/entry/pycon-apac-2023-practice-test-talk-extra-awesome-unittest">unittest ãŠã™ã™ã‚ãƒªãƒ³ã‚¯é›†</a></p></li>
</ul>
</section>
<section >
<h3>ãƒ†ã‚¹ãƒˆã‚’æ›¸ã„ã¦ã„ã‚‹ã‚ãªãŸã¸</h3>
<p>æ‹™ãƒ–ãƒ­ã‚° <a class="reference external" href="https://nikkie-ftnext.hatenablog.com/entry/pycon-apac-2023-practice-test-talk-extra-test-topics-commentary">ãƒ†ã‚¹ãƒˆã‚’æ›¸ãã‚ˆã†ã«ãªã£ãŸã‚ãªãŸã¨èªã‚ŠãŸã„ãƒˆãƒ”ãƒƒã‚¯é›†</a></p>
</section>
</section>
<section>
<section >
<h2>ã‚¿ã‚¤ãƒˆãƒ«ã®ç§˜å¯†</h2>
<ul class="simple">
<li><p>Twitterã§è¦‹ã‹ã‘ãŸ <a class="reference external" href="https://dic.nicovideo.jp/a/%E3%81%A1%E3%82%88%E7%88%B6">ã¡ã‚ˆçˆ¶</a> ã®ç”»åƒ</p>
<ul>
<li><p>å…ƒã¯ã€Œ<em>ãƒˆãƒãƒˆã‚’é£Ÿã¹ã‚‹ã‚“ã </em>ã€ğŸ…</p></li>
</ul>
</li>
</ul>
</section>
<section >
<h3>äºœç¨®</h3>
<blockquote class="twitter-tweet"><p lang="ja" dir="ltr">å¥½ãã¨ã‹å«Œã„ã¨ã‹ã¯ã„ã„ã€‚<br>ãƒ†ã‚¹ãƒˆã‚’æ›¸ãã‚“ã <br><br>ã®äºœç¨®ã ï¼ <a href="https://t.co/f17s6awgNB">https://t.co/f17s6awgNB</a></p>&mdash; nikkie ã«ã£ããƒ¼ (@ftnext) <a href="https://twitter.com/ftnext/status/1652328636970844161?ref_src=twsrc%5Etfw">April 29, 2023</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></section>
</section>
<section >
<h2>EOF</h2>
</section>

        </div>
    </div>
    
    <script src="../_static/revealjs4/dist/reveal.js"></script>
    
    
      <script src="../_static/revealjs4/plugin/highlight/highlight.js"></script>
      <script src="../_static/revealjs4/plugin/notes/notes.js"></script>
      
    
    <script>
        var revealjsConfig = new Object();
        Object.assign(revealjsConfig, 
    {
        controls: true,
        progress: true,
        history: true,
        center: true,
        transition: "none",
        slideNumber: "c/t",
    }
);
        
        
        
          revealjsConfig.plugins = [
            RevealHighlight,RevealNotes,
          ];
        
        // More info https://github.com/hakimel/reveal.js#configuration
        Reveal.initialize(revealjsConfig);
    </script>

  </body>
</html>